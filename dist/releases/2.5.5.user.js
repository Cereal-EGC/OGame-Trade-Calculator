// ==UserScript==
// @name	   OGame Trade Calculator
// @description    Adds a trade calculator to the OGame interface
// @namespace      http://userscripts.org/users/68563/scripts
// @downloadURL    https://userscripts.org/scripts/source/151002.user.js
// @updateURL      https://userscripts.org/scripts/source/151002.meta.js
// @version	2.5.5
// @include	*://*.ogame.*/game/index.php?*page=*
// ==/UserScript==
/*! OGame Trade Calculator (C) 2012 Elías Grande Cásedas | GNU-GPL | gnu.org/licenses */
(function(){var l,k={VERSION:[2,5,5],ID_PREFIX:(l="o_trade_calc_"),NAME:"OGame Trade Calculator",HOME_URL:"http://userscripts.org/scripts/show/151002",UPDATE_URL:"https://userscripts.org/scripts/source/151002.meta.js",UPDATE_JSONP:"https://dl.dropbox.com/u/89283239/OGame%20Trade%20Calculator/dist/updater.js",DOWNLOAD_URL:"https://userscripts.org/scripts/source/151002.user.js",TESTED_OGAME_VERSION:"5.2.0-beta7"},g=function(e){var r,q=e.split(/\D+/g);for(r in q){q[r]=parseInt(q[r])}return q},n=function(v,u,q){var s,r=v.length,e=u.length,t=Math.min(r,e);for(s=0;s<t;s++){if(v[s]>u[s]){return false}else{if(v[s]<u[s]){return true}}}if(r>e){return false}if(r<e){return true}if(arguments.length>2&&q){return true}return false};var i=window,o,f;try{if(unsafeWindow){i=unsafeWindow}}catch(j){}o=i.document;f=i.jQuery;var h={obj:i.localStorage,set:function(q,e){return this.obj.setItem(l+q,JSON.stringify(e))},get:function(q){var e=this.obj.getItem(l+q);return(e==null)?null:JSON.parse(e)},remove:function(e){return this.obj.removeItem(l+e)}};String.prototype.replaceAll=function(e,q){return this.split(e).join(q)};String.prototype.recursiveReplaceMap=function(t,s,q){if(q==0){return this.split(t[0]).join(s[0])}var r,e=this.split(t[q]);for(r in e){e[r]=e[r].recursiveReplaceMap(t,s,q-1)}return e.join(s[q])};String.prototype.replaceMap=function(e){var q,t,s,r;t=new Array();s=new Array();r=0;for(q in e){t.push(q);s.push(e[q]);r++}if(r==0){return this}else{return this.recursiveReplaceMap(t,s,r-1)}};String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)};String.prototype.trim=function(){return this.replace(/^\s+/,"").replace(/\s+$/,"")};var a=function(){f=i.jQuery;f.getScript("/cdn/js/greasemonkey/version-check.js",function(){i.oGameVersionCheck(k.NAME,k.TESTED_OGAME_VERSION,k.HOME_URL)});
/*! jCaret (C) 2010 C. F. Wong | cloudgen.w0ng.hk | www.opensource.org/licenses/mit-license.php */
(function(V,T,U,W){V.fn.caret=function(al,ah){var Y,ab,aj=this[0],ad=V.browser.msie;if(typeof al==="object"&&typeof al.start==="number"&&typeof al.end==="number"){Y=al.start;ab=al.end}else{if(typeof al==="number"&&typeof ah==="number"){Y=al;ab=ah}else{if(typeof al==="string"){if((Y=aj.value.indexOf(al))>-1){ab=Y+al[T]}else{Y=null}}else{if(Object.prototype.toString.call(al)==="[object RegExp]"){var ai=al.exec(aj.value);if(ai!=null){Y=ai.index;ab=Y+ai[0][T]}}}}}if(typeof Y!="undefined"){if(ad){var ae=this[0].createTextRange();ae.collapse(true);ae.moveStart("character",Y);ae.moveEnd("character",ab-Y);ae.select()}else{this[0].selectionStart=Y;this[0].selectionEnd=ab}this[0].focus();return this}else{if(ad){var ag=document.selection;if(this[0].tagName.toLowerCase()!="textarea"){var Z=this.val(),ac=ag[U]()[W]();ac.moveEnd("character",Z[T]);var ak=(ac.text==""?Z[T]:Z.lastIndexOf(ac.text));ac=ag[U]()[W]();ac.moveStart("character",-Z[T]);var af=ac.text[T]}else{var ac=ag[U](),X=ac[W]();X.moveToElementText(this[0]);X.setEndPoint("EndToEnd",ac);var ak=X.text[T]-ac.text[T],af=ak+ac.text[T]}}else{var ak=aj.selectionStart,af=aj.selectionEnd}var aa=aj.value.substring(ak,af);return{start:ak,end:af,text:aa,replace:function(am){return aj.value.substring(0,ak)+am+aj.value.substring(af,aj.value[T])}}}}})(f,"length","createRange","duplicate");
/*! [/jCaret] */
var q=({getMeta:function(T,U){try{return f('meta[name="'+T+'"]').attr("content")}catch(V){if(arguments.length>1){return U}else{return null}}},init:function(){return{LANGUAGE:this.getMeta("ogame-language",""),VERSION:g(this.getMeta("ogame-version","0"))}}}).init();var B={
/*! [colors] */
MET:"#FF7700",CRY:"#00FFFF",DEU:"#FF33FF",SC:"#FFFFFF",LC:"#FFFFFF"
/*! [/colors] */
};var C=({text:{},set:function(T,U){if(T.test(q.LANGUAGE)){f.extend(true,this.text,U)}return this},init:function(){var T=(i.initAjaxResourcebox+"").split(/tooltip\s*[\"\']\s*\:\s*[\"\']/);this.text.RES_MET=T[1].split("|").shift();this.text.RES_CRY=T[2].split("|").shift();this.text.RES_DEU=T[3].split("|").shift();return this}}).init(
/*! [i18n=en] */
).set(/.*/,{THO_SEP:",",DEC_SEP:".",MENU:"Trade C.",TITLE:"Trade calculator",CONFIG:"Settings",UPD_AVA:"Update available",INSTALL:"Install",GO_HOME:"Visit the site of the script",ACTION:"Action",BUY:"I buy",SELL:"I sell",RATIO:"Ratio",ILLEGAL:"illegal",MAX:"Maximum",REG:"Regular",MIN:"Minimum",IN_EXCH:"In exchange for",RESULT:"Result",SEND:"I send",RECEIVE:"I receive",RES:"Resources",LC_SHIP:"LC",SC_SHIP:"SC",OR:"or",MESSAGE:"Message",WHERE:"Place of delivery",PLANET:"Planet",MOON:"Moon",CUR_PLA:"Current planet",SEL_CUR:"Select current planet or moon",RAT_LST:"Ratio list",NAME:"Name",LEGAL:"Legal",YES:"Yes",NO:"No",DEFAULT:"Default",NEW:"New",DEF_VAL:"Default values",ABB_KEY:"Abbreviations and auto-complete keys",USE_ABB:"Use abbreviations when possible",UNABB:"Unabbreviate fields when the mouse is over them",ABB_MIL:"Abbreviation for millions",ABB_THO:"Abbreviation for thousands",KEY_MIL:"Key to write millions (6 zeros)",KEY_THO:"Key to write thousands (3 zeros)",MES_TPL:"Message template",RES_DTP:"Restore default template",IE_CONF:"Import / Export configuration",IMPORT:"Import",EXPORT:"Export",ACCEPT:"Accept",CANCEL:"Cancel",RES_DEF:"Restore default settings",CONTACT:"Contact information"}
/*! [i18n=es] */
).set(/es|ar|mx/,{THO_SEP:".",DEC_SEP:",",MENU:"C. Comercio",TITLE:"Calculadora de comercio",CONFIG:"Configuración",UPD_AVA:"Actualización disponible",INSTALL:"Instalar",GO_HOME:"Visitar página del script",ACTION:"Acción",BUY:"Compro",SELL:"Vendo",RATIO:"Ratio",ILLEGAL:"ilegal",MAX:"Máximo",REG:"Normal",MIN:"Mínimo",IN_EXCH:"A cambio de",RESULT:"Resultado",SEND:"Envío",RECEIVE:"Recibo",RES:"Recursos",LC_SHIP:"NGC",SC_SHIP:"NPC",OR:"o",MESSAGE:"Mensaje",WHERE:"Lugar de entrega",PLANET:"Planeta",MOON:"Luna",CUR_PLA:"Planeta actual",SEL_CUR:"Seleccionar planeta o luna actual",RAT_LST:"Lista de ratios",NAME:"Nombre",LEGAL:"Legal",YES:"Si",NO:"No",DEFAULT:"Por defecto",NEW:"Nuevo",DEF_VAL:"Valores por defecto",ABB_KEY:"Abreviaciones y teclas de autocompletado",USE_ABB:"Usar abreviaciones cuando sea posible",UNABB:"Desabreviar campos al poner el ratón encima",ABB_MIL:"Abreviación para millones",ABB_THO:"Abreviación para miles",KEY_MIL:"Tecla para escribir millones (6 ceros)",KEY_THO:"Tecla para escribir miles (3 ceros)",MES_TPL:"Plantilla de mensaje",RES_DTP:"Restaurar plantilla por defecto",IE_CONF:"Importar / Exportar configuración",IMPORT:"Importar",EXPORT:"Exportar",ACCEPT:"Aceptar",CANCEL:"Cancelar",RES_DEF:"Restaurar ajustes por defecto",CONTACT:"Información de contacto"}
/*! [i18n=nl] by sanctuary http://userscripts.org/users/431052 */
).set(/nl/,{THO_SEP:",",DEC_SEP:".",MENU:"Trade C.",TITLE:"Trade calculator",CONFIG:"Instellingen",UPD_AVA:"Update beschikbaar",INSTALL:"Installeren",GO_HOME:"Bezoek de web van het script",ACTION:"Actie",BUY:"Ik koop",SELL:"Ik verkoop",RATIO:"Verhouding",ILLEGAL:"illegaal",MAX:"Maximaal",REG:"Gemiddeld",MIN:"Minimaal",IN_EXCH:"In ruil voor",RESULT:"Resultaat",SEND:"Ik verstuur",RECEIVE:"Ik ontvang",RES:"Grondstoffen",LC_SHIP:"GV",SC_SHIP:"KV",OR:"of",MESSAGE:"Bericht",WHERE:"Plaats van levering",PLANET:"Planeet",MOON:"Maan",CUR_PLA:"Huidige planeet",SEL_CUR:"Kies huidige planeet of maan",RAT_LST:"Verhouding lijst",NAME:"Naam",LEGAL:"Legaal",YES:"Ja",NO:"Nee",DEFAULT:"Standaard",NEW:"Nieuw",DEF_VAL:"Standaard waarde",ABB_KEY:"Toets afkortingen en automatisch aanvullen",USE_ABB:"Gebruik afkortingen wanneer mogelijk",UNABB:"Verkort velden wanneer de muis over het veld staat",ABB_MIL:"Afkorting voor miljoen",ABB_THO:"Afkorting voor duizend",KEY_MIL:"Toets voor miljoen te schrijven (6 nullen)",KEY_THO:"Toets voor duizend te schrijven (3 nullen)",MES_TPL:"Bericht sjabloon",RES_DTP:"Herstel standaard sjabloon",IE_CONF:"Invoer / Uitvoer configuratie",IMPORT:"Invoer",EXPORT:"Uitvoer",ACCEPT:"Accepteer",CANCEL:"Annuleer",RES_DEF:"Herstel naar standaard instellingen",CONTACT:"Contactinformatie"}
/*! [/i18n] */
).text;var v={
/*! [css] */
CSS:"#"+l+"window select{visibility:visible !important;}#"+l+"window{float:left;position:relative;width:670px;overflow:visible;z-index:2;}#galaxy #"+l+"window{top:-44px;}#"+l+'header{height:28px;position: relative;background: url("http://gf1.geo.gfsrv.net/cdn63/10e31cd5234445e4084558ea3506ea.gif") no-repeat scroll 0px 0px transparent;}#'+l+"header h4{height:28px;line-height:28px;text-align:center;color:#6F9FC8;font-size:12px;font-weight:bold;position:absolute;top:0;left:100px;right:100px;}#"+l+"config_but{display:block;height:16px;width:16px;background:url(http://gf3.geo.gfsrv.net/cdne7/1f57d944fff38ee51d49c027f574ef.gif);float:right;margin:8px 0 0 0;opacity:0.5;}#"+l+"config_but:hover{opacity:1;}#"+l+'window.config input[type="button"]{margin:0 5px 0 5px;}#'+l+"config,#"+l+"window.config #"+l+"calc,#"+l+"window.config #"+l+"config_but,#"+l+"window.calc ."+l+"config_only{display:none;}#"+l+"window.config #"+l+"config{display:block;}#"+l+"main,#"+l+'update{padding:15px 25px 0 25px;background: url("http://gf1.geo.gfsrv.net/cdn9e/4f73643e86a952be4aed7fdd61805a.gif") repeat-y scroll 5px 0px transparent;}#'+l+"main *{font-size:11px;}#"+l+"update div{font-size:11px;border:1px solid #000;color:#99CC00;line-height:30px;text-align:center;font-weight:bold;}#"+l+"update a{margin-left:15px;}#"+l+"window table{width:620px;background-color:#0D1014;border-collapse:collapse;clear:both;}#"+l+"window.calc table{border:1px solid #000;margin:0 0 20px 0;}#"+l+"window.calc table.last{margin:0;}#"+l+"window.config table{width:598px;}#"+l+"main th{color:#6F9FC8;text-align:center;font-weight:bold;}."+l+"label,."+l+"label *{color:grey;text-align:left;}."+l+"label{padding:0 5px 0 5px;font-weight:bold;}#"+l+"window.config ."+l+"label{text-align:center;}#"+l+"main tr,#"+l+"main td,#"+l+"main th{height:28px;line-height:28px;}#"+l+'main input[type="text"]{width:100px;text-align:center;}option.'+l+"highlight{color:lime !important;font-weight:bold;}option."+l+"moon{color:orange;}."+l+"select{width:150px;text-align:left;}."+l+"select select{width:130px;text-align:center;}#"+l+"main option{padding:1px 5px 1px 5px;}."+l+"input,."+l+"output{width:112px;padding:0 2px 0 0;}."+l+"name{width:142px;padding:0 1px 0 1px;text-align:right;}#"+l+"main ."+l+"name input{width:130px;text-align:center;}."+l+"ratio{width:82px;padding:0 1px 0 1px;text-align:right;}#"+l+"main ."+l+"ratio input{width:70px;text-align:center;}#"+l+"ratio_illegal{color:red;}."+l+"output{text-align:center;font-weight:bold;}#"+l+"output_met{color:"+B.MET+";}#"+l+"output_cry{color:"+B.CRY+";}#"+l+"output_deu{color:"+B.DEU+";}."+l+"textarea{padding:0 3px 0 3px !important;}#"+l+"message{width:601px;height:50px !important;margin:0 !important;}#"+l+"planet{width:auto;text-align:left;margin:0;}."+l+"select1row{padding-left:2px;}."+l+"select1row select{width:250px !important;text-align:left;margin:0;}#"+l+"selCurPla_button{margin-left:30px}#"+l+'footer{height:17px;background: url("http://gf1.geo.gfsrv.net/cdn30/aa3e8edec0a2681915b3c9c6795e6f.gif") no-repeat scroll 2px 0px transparent;}.'+l+'config_title{font-size:11px;font-weight:bold;color:#6F9FC8;line-height:22px;background:url("http://gf1.geo.gfsrv.net/cdn0b/d55059f8c9bab5ebf9e8a3563f26d1.gif") no-repeat scroll 0 0 #13181D;height:22px;margin:0 0 10px 0;padding:0 0 0 40px;border:1px solid #000;overflow:hidden;cursor:pointer;}.'+l+"config_title:hover{color:#A7AFB7;background-color:#23282D;border-color:#13181D;}."+l+"config_box{border:1px solid #000;margin:5px 5px 10px 5px;padding:5px;}#"+l+"new_ratio input{border-color:#9C0;}."+l+"check,."+l+"name_noedit{text-align:center;}."+l+"check input{vertical-align:text-bottom;}."+l+'check input[type="checkbox"]{vertical-align:middle;}.'+l+"action{text-align:center;padding:0 3px 0 3px;}."+l+'action a{background:url("http://gf1.geo.gfsrv.net/cdn94/297ee218d94064df0a66bd41a04d28.png") scroll 0 0 no-repeat;width:16px;height:16px;display:inline-block;vertical-align:top;position:relative;top:5px;border:1px solid #000;border-radius:2px;opacity:0.7;}a.'+l+"icon_up,a."+l+"icon_down,a."+l+"icon_add{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAwCAMAAAAvgQplAAAAAXNSR0IArs4c6QAAAvpQTFRFbomeXHaLb4mdgpyveJaxdpSweZKk////W3qXVnKNRWB6AAAANTU1PT09MUJTJzVD/6gAzAAA/9IA/wAAqsrjvtjrna25PlVsTWiCqbjESGF6YHyaOk9ldZOwTWeCPj4+PlRsVHeYRGKBUXCRQVx6VnibTGmFVnmbRWOERWSEXn+chJusPVhzU3SVQ19+TGyKU3aXPVRrTGqHkrHKPVZwUW6KQ2GAU3aZO09lcJCqYHqORV95UW6LTGeBQFlySGB5SmF6Q2B+VnmaUG2JVnSQS2qHSmeCL0RaXHmUU3WVoLzSqcTYQ2GCPFZxPVZxkaa1RWSDPFZyRl96XH2ZTGqGS2qJO1Ru1d7lV3SROk5kQVp0QVpz5erua4OWqLnGpcDUWn2ewMzVlK/EqLbCcY+qj6zESmF3r7zHob3TTGaAlqi2haO9XniNQ115TWiD8vX4k7DGZ4mqyNTdSmaBpcHWcImdjaKynbrRdY6hvMnTSWeHYXyaq7jDV3SQ6+/zo7/Ur8rd8PP1javGhaK82uLmq8bZq7vHh6a+0NrgnLjOhJqqUG+QpL/VsL7JdJOuXnmSytTcj6OxT2qE+Pn7eZm0zCszfZmxhqXBdZGpXHaOS2uKboynr73J4ebrhKO7obLAmLfR+vv9nLfNip+uX3yYXn+bdoyec42gobC9pbS/yNPbYX2aPVRtt8XPmLTLbo2odI2geI2fVHKT2OHo3OLoRGGBRmODkK7HaImkaomka4unjaCw/f7/mbjRXnyXd4+jf5Wmp8HWjq3IiqnEeZOqPlVtVHeXYH2ai6CxYYCbZIKfZn+TTGeDVnWQb5GtVnWRSWWASmWATGuKc5CpusXOU3GQlLPMXHqXUnSUZoSifJq0fJu3ZHyT/v//dpOwqcXZYHqSYnuQ7fDz7PD0XHyYWnaRkKW1TGiFTGmEj6zDYXuPPFdzPVdzrsndhpytVHaYh52uXn6c8PP2jqzFQFt5jKvFcYqeQl99gZ+52uHmRGKAyNTcV3iaqsbZDVW+rgAAAAF0Uk5TAEDm2GYAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH3AsJFTcNV6u1fQAAAE9JREFUKM/dkjEOACAIA6tL//9jFaORqhtxsBO9CS4AyQXSKwkEpAfkIMgttNh4AUtCALQ/9NGPu4A87/erj/6DD30HBZuPwztsPmIFqY8CjdEFo21taJsAAAAASUVORK5CYII=);}a."+l+"icon_down{background-position:0px -16px}a."+l+"icon_add{background-position:0px -32px}."+l+"action a:hover{opacity:1;border-color:#08090b;}."+l+"action a.disabled,."+l+"action aldisabled:hover{opacity:0.1;cursor:default;}a."+l+"icon_trash{background-position:0px -304px}#"+l+"window.config .undermark,#"+l+"window.config .overmark{font-weight:bold;text-align:center;}#"+l+"window.config textarea{display:block;width:586px;margin:0 0 5px 0;}."+l+"ie_conf{text-align:center}."+l+"hidden{position:fixed;left:-10000px;}."+l+"fieldwrapper:before,."+l+'fieldwrapper:after{content:"";display:table;}.'+l+"fieldwrapper:after{clear:both;}."+l+"fieldwrapper{padding:7px 0 7px 0;}."+l+"fieldwrapper label,."+l+"thefield{color:#6F9FC8;height:22px;line-height:22px;float:left;margin:2px 0 0 0;}."+l+"fieldwrapper label{font-weight:bold;width:320px;margin:0 15px 0 0;padding:0 0 0 10px;}."+l+'thefield input[type="text"],.'+l+"thefield select{width:200px}",
/*! [tpl=action_options] */
ACTION_OPT:'<option value="sell">'+C.SELL+'</option><option value="buy">'+C.BUY+"</option>",
/*! [tpl=output_options] */
OUTPUT_OPT:'<option value="m">'+C.RES_MET+'</option><option value="c">'+C.RES_CRY+'</option><option value="d">'+C.RES_DEU+'</option><option value="mc">'+C.RES_MET+" + "+C.RES_CRY+'</option><option value="md">'+C.RES_MET+" + "+C.RES_DEU+'</option><option value="cd">'+C.RES_CRY+" + "+C.RES_DEU+"</option>",
/*! [tpl=void_href] */
VOID_HREF:'href="javascript:void(0)"',
/*! [tpl=window] */
WINDOW:'<div id="'+l+'window" class="calc"><div id="'+l+'header"><h4>'+C.TITLE+'<span class="'+l+'config_only"> &raquo; '+C.CONFIG+'</span></h4><a id="'+l+'close" href="javascript:void(0);" class="close_details close_ressources"></a><a id="'+l+'config_but" href="javascript:void(0);"></a></div><div id="'+l+'main"><div id="'+l+'calc"><table cellspacing="0" cellpadding="0"><tbody><tr><th colspan="2"></th><th>'+C.RES_MET+"</th><th>"+C.RES_CRY+"</th><th>"+C.RES_DEU+'</th></tr><tr class="alt"><td class="'+l+'label">'+C.ACTION+'</td><td class="'+l+'select"><select id="'+l+'action">{this.ACTION_OPT}</select></td><td class="'+l+'input"><input id="'+l+'input_met" type="text" value=""></td><td class="'+l+'input"><input id="'+l+'input_cry" type="text" value=""></td><td class="'+l+'input"><input id="'+l+'input_deu" type="text" value=""></td></tr><tr><td class="'+l+'label">'+C.RATIO+'<span id="'+l+'ratio_illegal"> ('+C.ILLEGAL+')</span></td><td class="'+l+'select"><select id="'+l+'ratio"></select></td><td class="'+l+'input"><input id="'+l+'ratio_met" type="text" value=""></td><td class="'+l+'input"><input id="'+l+'ratio_cry" type="text" value=""></td><td class="'+l+'input"><input id="'+l+'ratio_deu" type="text" value=""></td></tr><tr class="alt"><td class="'+l+'label">'+C.IN_EXCH+'</td><td class="'+l+'select"><select id="'+l+'output">{this.OUTPUT_OPT}</select></td><td class="'+l+'input"><input id="'+l+'percent_met" type="text" value=""></td><td class="'+l+'input"><input id="'+l+'percent_cry" type="text" value=""></td><td class="'+l+'input"><input id="'+l+'percent_deu" type="text" value=""></td></tr><tr><td class="'+l+'label" colspan="2">'+C.RESULT+'</td><td class="'+l+'output" id="'+l+'output_met"></td><td class="'+l+'output" id="'+l+'output_cry"></td><td class="'+l+'output" id="'+l+'output_deu"></td></tr></tbody></table><table cellspacing="0" cellpadding="0"><tbody><tr><th></th><th>'+C.RES+"</th><th>"+C.LC_SHIP+"</th><th>"+C.SC_SHIP+'</th></tr><tr class="alt"><td class="'+l+'label">'+C.SEND+'</td><td class="'+l+'output overmark" id="'+l+'sendRes">0</td><td class="'+l+'output" id="'+l+'sendLC">0</td><td class="'+l+'output" id="'+l+'sendSC">0</td></tr><tr><td class="'+l+'label">'+C.RECEIVE+'</td><td class="'+l+'output undermark" id="'+l+'receiveRes">0</td><td class="'+l+'output" id="'+l+'receiveLC">0</td><td class="'+l+'output" id="'+l+'receiveSC">0</td></tr></tbody></table><table cellspacing="0" cellpadding="0"><tbody><tr class="alt"><td class="'+l+'label" colspan="5">'+C.WHERE+'</td></tr><tr class="alt"><td class="'+l+'select1row" colspan="5"><select id="'+l+'planet"></select><a {this.VOID_HREF} id="'+l+'selCurPla_button">'+C.SEL_CUR+'</a></td></tr></tbody></table><table cellspacing="0" cellpadding="0" class="last"><tbody><tr class="alt"><td class="'+l+'label" colspan="5">'+C.MESSAGE+'</td></tr><tr class="alt"><td class="'+l+'textarea" colspan="5"><textarea id="'+l+'message" cols="1" rows="1" readonly="readonly"></textarea></td></tr></tbody></table></div><div id="'+l+'config"><div class="'+l+'config_title">'+C.RAT_LST+'</div><div class="'+l+'config_box"><table cellspacing="0" cellpadding="0"><tbody id="'+l+'ratioList"><tr><th>#</th><th>'+C.NAME+"</th><th>"+C.RES_MET+"</th><th>"+C.RES_CRY+"</th><th>"+C.RES_DEU+"</th><th>"+C.ACTION+"</th><th>"+C.LEGAL+"</th><th>"+C.DEFAULT+'</th></tr></tbody></table></div><div class="'+l+'config_title">'+C.DEF_VAL+'</div><div class="'+l+"config_box "+l+'hidden"><div class="'+l+'fieldwrapper"><label>'+C.ACTION+':</label><div class="'+l+'thefield"><select id="'+l+'defAction">{this.ACTION_OPT}</select></div></div><div class="'+l+'fieldwrapper"><label>'+C.IN_EXCH+':</label><div class="'+l+'thefield"><select id="'+l+'defOutput">{this.OUTPUT_OPT}</select></div></div><div class="'+l+'fieldwrapper"><label>'+C.SEL_CUR+':</label><div class="'+l+'thefield"><input id="'+l+'selCurPla" type="checkbox" /></div></div></div><div class="'+l+'config_title">'+C.ABB_KEY+'</div><div class="'+l+"config_box "+l+'hidden"><div class="'+l+'fieldwrapper"><label>'+C.USE_ABB+':</label><div class="'+l+'thefield"><input id="'+l+'abb" type="checkbox" /></div></div><div class="'+l+'fieldwrapper"><label>'+C.UNABB+':</label><div class="'+l+'thefield"><input id="'+l+'overUnabb" type="checkbox" /></div></div><div class="'+l+'fieldwrapper"><label>'+C.ABB_MIL+':</label><div class="'+l+'thefield"><input id="'+l+'millionAbb" type="text" maxlength="10" /></div></div><div class="'+l+'fieldwrapper"><label>'+C.ABB_THO+':</label><div class="'+l+'thefield"><input id="'+l+'thousandAbb" type="text" maxlength="10" /></div></div><div class="'+l+'fieldwrapper"><label>'+C.KEY_MIL+':</label><div class="'+l+'thefield"><input id="'+l+'millionKey" type="text" maxlength="1" /></div></div><div class="'+l+'fieldwrapper"><label>'+C.KEY_THO+':</label><div class="'+l+'thefield"><input id="'+l+'thousandKey" type="text" maxlength="1" /></div></div></div><div class="'+l+'config_title">'+C.MES_TPL+'</div><div class="'+l+"config_box "+l+'hidden"><textarea id="'+l+'messageTpl"></textarea><div class="textCenter"><input id="'+l+'messageTpl_restore" type="button" value="'+C.RES_DTP+'" class="btn_blue"></div></div><div class="'+l+'config_title">'+C.IE_CONF+'</div><div class="'+l+"config_box "+l+"ie_conf "+l+'hidden"><textarea id="'+l+'ie_conf"></textarea><input id="'+l+'ie_import" type="button" value="'+C.IMPORT+'" class="btn_blue"><input id="'+l+'ie_export" type="button" value="'+C.EXPORT+'" class="btn_blue"></div><div class="'+l+'config_title">'+C.CONTACT+'</div><div class="'+l+"config_box "+l+'hidden"><table cellspacing="0" cellpadding="0"><tbody><tr class="alt"><td class="'+l+"label "+l+'pos">1</td><td>Userscripts</td><td><a href="http://userscripts.org/scripts/discuss/151002" target="_blank">Discuss OGame Trade Calculator - userscripts.org</a></td></tr><tr><td class="'+l+"label "+l+'pos">2</td><td>Ogame Origin</td><td><a href="http://board.origin.ogame.de/board6-origin/board38-tools-scripts-skins/board39-tolerated-tools-addons-scripts/4367-ogame-trade-calculator/" target="_blank">[Tolerated] OGame Trade Calculator - board.origin.ogame.de</a></td></tr><tr class="alt"><td class="'+l+"label "+l+'pos">3</td><td>Ogame España</td><td><a href="http://board.ogame.com.es/board859-ogamelacomunidad/board860-comunidad/board422-utilidadesyskinsparaogame/1224751-scriptcalculadoradecomerciolegal/" target="_blank">[Script] Calculadora de Comercio [Legal] - board.ogame.com.es</a></td></tr></tbody></table></div><div class="textCenter"><input id="'+l+'config_accept" type="button" value="'+C.ACCEPT+'" class="btn_blue"><input id="'+l+'config_cancel" type="button" value="'+C.CANCEL+'" class="btn_blue"><input id="'+l+'config_default" type="button" value="'+C.RES_DEF+'" class="btn_blue"></div></div></div><div id="'+l+'footer"></div></div>',
/*! [tpl=button] */
MENUBUTTON:'<li><a id="'+l+'menubutton" class="menubutton" href="javascript:void(0)" accesskey="" target="_self"><span class="textlabel">'+C.MENU+"</span></a></li>",
/*! [tpl=ratio_list_limit] */
RATIO_LIST_LIMIT:'<tr><td class="'+l+"label "+l+'pos"></td><td class="'+l+'name_noedit"></td><td class="'+l+'ratio"><input class="'+l+'edit_ratio_met" type="text" /></td><td class="'+l+'ratio"><input class="'+l+'edit_ratio_cry" type="text" /></td><td class="'+l+'ratio"><input class="'+l+'edit_ratio_deu" type="text" /></td><td class="'+l+'action"><a {this.VOID_HREF} class="'+l+'icon_up"></a><a {this.VOID_HREF} class="'+l+'icon_down"></a><a {this.VOID_HREF} class="'+l+'icon_trash disabled"></a></td><td class="'+l+'label">-</td><td class="'+l+'check"><input name="'+l+'def_ratio" type="radio" /></td></tr>',
/*! [tpl=ratio_list_item] */
RATIO_LIST_ITEM:'<tr><td class="'+l+"label "+l+'pos"></td><td class="'+l+'name"><input class="'+l+'edit_ratio_name" type="text" /></td><td class="'+l+'ratio"><input class="'+l+'edit_ratio_met" type="text" /></td><td class="'+l+'ratio"><input class="'+l+'edit_ratio_cry" type="text" /></td><td class="'+l+'ratio"><input class="'+l+'edit_ratio_deu" type="text" /></td><td class="'+l+'action"><a {this.VOID_HREF} class="'+l+'icon_up"></a><a {this.VOID_HREF} class="'+l+'icon_down"></a><a {this.VOID_HREF} class="'+l+'icon_trash"></a></td><td class="'+l+'legal"></td><td class="'+l+'check"><input name="'+l+'def_ratio" type="radio" /></td></tr>',
/*! [tpl=ratio_list_new] */
RATIO_LIST_NEW:'<tr id="'+l+'new_ratio"><td class="undermark '+l+'pos"></td><td class="'+l+'name"><input class="'+l+'edit_ratio_name" type="text" /></td><td class="'+l+'ratio"><input class="'+l+'edit_ratio_met" type="text" /></td><td class="'+l+'ratio"><input class="'+l+'edit_ratio_cry" type="text" /></td><td class="'+l+'ratio"><input class="'+l+'edit_ratio_deu" type="text" /></td><td class="'+l+'action"><a {this.VOID_HREF} class="'+l+'icon_add"></a></td><td class="'+l+'legal"></td><td class="'+l+'label">-</td></tr>',
/*! [tpl=update] */
UPDATE:'<div id="'+l+'update"><div>Actualización disponible'+((typeof(GM_xmlhttpRequest)=="undefined")?"":('<a target="_blank" href="'+k.DOWNLOAD_URL+'">Instalar</a>'))+'<a target="_blank" href="'+k.HOME_URL+'">Ir a la página del script</a></div></div>',
/*! [/tpl] */
init:function(){for(var U in this){if(typeof(this[U])=="string"){for(var T in this){if(typeof(this[T])=="string"){this[U]=this[U].replaceAll("{this."+T+"}",this[T])}}}}}};var K=(function(){var T=f('meta[name="ogame-universe"]').attr("content");
/*! [default_ratios] */
return/^\w+\.ogame\.org$/.test(T)?[3,2,1,2,1,1,3,2,1]:[3,2,1,2,1.5,1,3,2,1];
/*! [/default_ratios] */
})();var H=function(){return(new Date()).getTime()};var r=function(){};var D=function(T){T.preventDefault()};var R={getDefaultData:function(){return{
/*! [config=default] */
version:k.VERSION.slice(0),defAction:"sell",ratioList:[{id:"MAX",ratio:[K[0],K[1],K[2]]},{id:"MIN",ratio:[K[3],K[4],K[5]]},{id:"REG",ratio:[K[6],K[7],K[8]]}],defRatio:"REG",defOutput:"m",millionAbb:"M",millionKey:"m",thousandAbb:"K",thousandKey:"k",abb:false,overUnabb:false,selCurPla:false,messageTpl:"[b]{?b}{I18N.BUY}{/b}{?s}{I18N.SELL}{/s}:[/b] {?m}[b][color={COLOR.MET}]{m}[/color][/b] ({I18N.RES_MET}){?cd} + {/cd}{/m}{?c}[b][color={COLOR.CRY}]{c}[/color][/b] ({I18N.RES_CRY}){?d} + {/d}{/c}{?d}[b][color={COLOR.DEU}]{d}[/color][/b] ({I18N.RES_DEU}){/d}\n[b]{I18N.IN_EXCH}:[/b] {?M}[b][color={COLOR.MET}]{M}[/color][/b] ({I18N.RES_MET}){?CD} + {/CD}{/M}{?C}[b][color={COLOR.CRY}]{C}[/color][/b] ({I18N.RES_CRY}){?D} + {/D}{/C}{?D}[b][color={COLOR.DEU}]{D}[/color][/b] ({I18N.RES_DEU}){/D}\n\n[b]* {I18N.SEND}:[/b] {sr} ({I18N.RES}) = [b][color={COLOR.LC}]{sl}[/color][/b] ({I18N.LC_SHIP}) {I18N.OR} [b][color={COLOR.SC}]{ss}[/color][/b] ({I18N.SC_SHIP})\n[b]* {I18N.RECEIVE}:[/b] {rr} ({I18N.RES}) = [b][color={COLOR.LC}]{rl}[/color][/b] ({I18N.LC_SHIP}) {I18N.OR} [b][color={COLOR.SC}]{rs}[/color][/b] ({I18N.SC_SHIP})\n\n[b]* {I18N.RATIO}:[/b] {rm}:{rc}:{rd}{?w}\n[b]* {I18N.WHERE}:[/b] {wg}:{ws}:{wp} ({wt}){/w}\n\n[b][url={SCRIPT.HOME_URL}]{SCRIPT.NAME}[/url][/b]"
/*! [/config] */
}},abbRE:/^\S+$/,keyRE:/^\S$/,_error:function(T){throw"DataError: "+T},_errorUndefined:function(T){this._error(T+" is undefined")},_errorExpected:function(T,U,V,W){var Y,X=V+"";if(/^[\<\>]\d+$/.test(X)){if(X.charAt(0)==">"){Y="greater"}else{Y="less"}Y+=" than "+X.slice(1)}else{Y='"'+X.split(":").join(" or ")+'"'}this._error(T+": "+U+" "+Y+' expected but "'+W+'" found')},_errorType:function(T,U,V){if(V=="undefined"){this._errorUndefined(T)}else{this._errorExpected(T,"type",U,V)}},_errorValue:function(T,U,V){this._errorExpected(T,"value",U,V)},_errorValueRE:function(T,U,V){this._error(T+': value "'+V+'" doesn\'t match the expected RegExp "'+U+'"')},_errorLength:function(T,U,V){this._errorExpected(T,"length",U,V)},parseData:function(U){var V,T,ad,W=this,X=(typeof(U)=="string")?JSON.parse(U):U,ae="boolean",ac="string",Y="number";if((ad=typeof(X.defAction))!=ac){W._errorType("defAction",ac,ad)}if(typeof(X.ratioList)=="undefined"){W._errorUndefined("ratioList")}if(!(/^sell|buy$/.test(X.defAction))){W._errorValue("defAction","sell:buy",X.defAction)}ad=typeof(X.defRatio);if(!(/^number|string$/.test(ad))){W._errorType("defRatio",ac+":"+Y,ad)}var Z=true,aa=true,ab=true;for(V=0;V<X.ratioList.length;V++){T=X.ratioList[V];if((ad=T.ratio.length)!=3){W._errorLength("ratioList["+V+"]",3,ad)}if((T.ratio[0]+=0)<=0){W._errorValue("ratioList["+V+"].ratio[0]",">0",T.ratio[0])}if((T.ratio[1]+=0)<=0){W._errorValue("ratioList["+V+"].ratio[1]",">0",T.ratio[1])}if((T.ratio[2]+=0)<=0){W._errorValue("ratioList["+V+"].ratio[2]",">0",T.ratio[2])}if(T.id==X.defRatio){ab=false}if(/^MAX|MIN|REG$/.test(T.id+"")){if(T.id=="MAX"){Z=false}else{if(T.id=="MIN"){aa=false}}}else{if((ad=typeof(T.id))!=Y){W._errorType("ratioList["+V+"].id",Y,ad)}if((ad=typeof(T.name))!=ac){W._errorType("ratioList["+V+"].name",ac,ad)}}}if(Z){W._error('ratioList: maximum ratio (id="MAX") not found')}if(aa){W._error('ratioList: minimum ratio (id="MIN") not found')}if(ab){W._error('ratioList: default ratio (id="'+X.defRatio+'" == defRatio) not found')}T=X.ratioList.slice(0).sort();for(V=1;V<T.length;V++){if(T[V-1].id==T[V].id){W._error('ratioList: duplicate id "'+T[V].id+'" found')}}if(!(/^m|c|d|mc|md|cd$/.test(X.defOutput))){W._errorValue("defOutput","m:c:d:mc:md:cd",X.defOutput)}if((ad=typeof(X.millionAbb))!=ac){W._errorType("millionAbb",ac,ad)}if((ad=X.millionAbb.length)<1){W._errorLength("millionAbb",">0",ad)}if(!W.abbRE.test(ad=X.millionAbb)){W._errorValueRE("millionAbb",W.abbRE,ad)}if((ad=typeof(X.millionKey))!=ac){W._errorType("millionKey",ac,ad)}if((ad=X.millionKey.length)!=1){W._errorLength("millionKey",1,ad)}if(!W.keyRE.test(ad=X.millionKey)){W._errorValueRE("millionKey",W.keyRE,ad)}if((ad=typeof(X.thousandAbb))!=ac){W._errorType("thousandAbb",ac,ad)}if((ad=X.thousandAbb.length)<1){W._errorLength("thousandAbb",">0",ad)}if(!W.abbRE.test(ad=X.thousandAbb)){W._errorValueRE("thousandAbb",W.abbRE,ad)}if((ad=typeof(X.thousandKey))!=ac){W._errorType("thousandKey",ac,ad)}if((ad=X.thousandKey.length)!=1){W._errorLength("thousandKey",1,ad)}if(!W.keyRE.test(ad=X.thousandKey)){W._errorValueRE("thousandKey",W.keyRE,ad)}if((ad=typeof(X.abb))!=ae){W._errorType("abb",ae,ad)}if((ad=typeof(X.overUnabb))!=ae){W._errorType("overUnabb",ae,ad)}if((ad=typeof(X.selCurPla))!=ae){W._errorType("selCurPla",ae,ad)}if((ad=typeof(X.messageTpl))!=ac){W._errorType("messageTpl",ac,ad)}return X},getRatio:function(U,X){var W=(arguments.length>1)?X.ratioList[U]:this.data.ratioList[U],Y=W.id+"",T,V=W.ratio.slice(0);if("name" in W){T=W.name+""}else{T=C[Y]}return{id:Y,ratio:V,name:T,val:Y+":"+V[0]+":"+V[1]+":"+V[2],met:V[0],cry:V[1],deu:V[2]}},getRatioById:function(X,V){var T,W=(arguments.length>1)?V:this.data,U=W.ratioList;for(T in U){if(U[T].id==X){return this.getRatio(T,W)}}return null},updateVersion:function(Y){var T=(typeof(Y.version)=="undefined")?0:Y.version,U,X=this.getDefaultData();if(n(T,[2,4])){Y.messageTpl=X.messageTpl}if(n(T,[2,5,3])){var W=Y.ratioList,V=false;for(U in W){if(W[U].id=="MAX"){break}}if(U<W.length||W[U].ratio.join(":")=="5:3:1"){W[U].ratio=this.getRatioById("MAX",X).ratio}}Y.version=X.version;for(U in X){if(typeof(Y[U])=="undefined"){Y[U]=X[U]}}return Y},save:function(T){if(arguments.length>0){this.data=T}this.data=this.updateVersion(this.data);h.set("config",this.data);return this},load:function(){var T=h.get("config");if(T==null){this.data=this.getDefaultData()}else{this.save(T)}return this},remove:function(){h.remove("config");this.data=this.getDefaultData()}};var E={formatI:function(X,V){var W,T=(arguments.length>1&&V);if(T&&X==""){return""}if(typeof(X)=="string"){W=("0"+X+"").replace(new RegExp(R.data.thousandKey+"$","i"),"000").replace(new RegExp(R.data.millionKey+"$","i"),"000000").replace(/\D/g,"").replace(/^0+(\d)/,"$1")}else{W=X.toFixed()+""}var U=/(\d+)(\d{3})/;while(U.test(W)){W=W.replace(U,"$1"+C.THO_SEP+"$2")}if(!T&&R.data.abb){return W.replace(/\D000\D000$/,R.data.millionAbb).replace(/\D(\d*[1-9]+)0*\D000$/,C.DEC_SEP+"$1"+R.data.millionAbb).replace(/\D000$/,R.data.thousandAbb)}return W},formatF:function(aa,Y){var Z,T,X,V,U=(arguments.length>1&&Y);if(U&&aa==""){return""}if(typeof(aa)=="string"){Z=("0"+aa+"").replace(/[\.\,]$/,C.DEC_SEP).replace(new RegExp("[^0-9\\"+C.DEC_SEP+"]","g"),"").replace(/^0+(\d)/,"$1")}else{Z=(aa+"").replace(".",C.DEC_SEP)}T=Z.split(C.DEC_SEP);X=T[0];V=T.length>1?C.DEC_SEP+T[1]:"";if(Z[Z.length-1]==C.DEC_SEP&&U){V=C.DEC_SEP}var W=/(\d+)(\d{3})/;while(W.test(X)){X=X.replace(W,"$1"+C.THO_SEP+"$2")}return X+V},parseI:function(U){var T=E.parseF(U);if(new RegExp(R.data.thousandAbb+"$","i").test(U)){T=T*1000}else{if(new RegExp(R.data.millionAbb+"$","i").test(U)){T=T*1000000}}return Math.round(T)},parseF:function(T){return parseFloat(T.replaceAll(C.THO_SEP,"").replace(C.DEC_SEP,".").replace(/[^\d\.]/g,""))}};var S=function(){if(arguments.length<1){this.setLimits()}else{if(arguments.length<2){this.setLimits(arguments[0])}else{this.setLimits(arguments[0],arguments[1])}}};S.prototype={limits:[],isLegal:function(){var V;if(arguments.length==1){V=arguments[0]}else{V=[arguments[0],arguments[1],arguments[2]]}var U=V[0]/V[1],T=0;if(U<this.limits[T++]||U>this.limits[T++]){return false}U=V[0]/V[2];if(U<this.limits[T++]||U>this.limits[T++]){return false}U=V[1]/V[2];if(U<this.limits[T++]||U>this.limits[T++]){return false}return true},setLimits:function(W,V){if(arguments.length<2){var aa,Z,X,Y=(arguments.length>0)?W.ratioList:R.data.ratioList;for(X in Y){if(Y[X].id=="MAX"){aa=Y[X].ratio}else{if(Y[X].id=="MIN"){Z=Y[X].ratio}}}return this.setLimits(aa,Z)}this.limits=[];var U=W[0]/W[1],T=V[0]/V[1];this.limits.push(Math.min(U,T));this.limits.push(Math.max(U,T));U=W[0]/W[2];T=V[0]/V[2];this.limits.push(Math.min(U,T));this.limits.push(Math.max(U,T));U=W[1]/W[2];T=V[1]/V[2];this.limits.push(Math.min(U,T));this.limits.push(Math.max(U,T));return this}};var J,F;var t=function(X,Y,W,aa,ab,Z,U,V,T){return{met:Math.round(((X+(Y/ab)*aa+(W/Z)*aa)/100)*U),cry:Math.round((((X/aa)*ab+Y+(W/Z)*ab)/100)*V),deu:Math.round((((X/aa)*Z+(Y/ab)*Z+W)/100)*T)}};var N={parseIf:function(Z,aa,T){var ab="{?"+aa+"}",W="{/"+aa+"}";if(T){return Z.split(ab).join("").split(W).join("")}var Y,X,U,V=Z;while((Y=V.indexOf(ab))>=0&&(X=V.indexOf(W))>=0&&Y<X){V=V.split(ab);for(Y=1;Y<V.length;Y++){U=V[Y].split(W);if(U.length>1){U.shift();V[Y]=W+U.shift()+U.join(W)}}V=V.join(ab).split(ab+W).join("")}return V},parseIfs:function(X,ab){var W=X+"",V=X+"",ad=/\{\?(\!?\w)+\}/,Z,ac,aa,U,T;while(ad.test(W)){Z=(ad.exec(W)+"").replace(/\}.*$/,"").replace(/^.*\{/,"");W=W.split("{"+Z+"}").join("");try{Z=Z.replace(/[^\w\!]/g,"");if((T=Z[aa=0])=="!"){ac=!ab[++aa]}else{ac=ab[T]}U=Z.length-1;ac=ab[Z[aa]];while(aa<U){if((T=Z[++aa])=="!"){ac=(ac||!ab[++aa])}else{ac=(ac||ab[T])}}V=this.parseIf(V,Z,ac)}catch(Y){alert(Y)}}return V},make:function(W,ab,T,V,U,aa,Y){var Z,ac=/[1-9]/,X=this.parseIfs(R.data.messageTpl,{b:(W=="buy"),s:(W=="sell"),m:ac.test(ab.met),c:ac.test(ab.cry),d:ac.test(ab.deu),M:ac.test(T.met),C:ac.test(T.cry),D:ac.test(T.deu),w:Y.use});X=X.replaceMap({"{m}":ab.met,"{c}":ab.cry,"{d}":ab.deu,"{M}":T.met,"{C}":T.cry,"{D}":T.deu,"{sr}":V.res,"{sl}":V.lc,"{ss}":V.sc,"{rr}":U.res,"{rl}":U.lc,"{rs}":U.sc,"{rm}":aa.met,"{rc}":aa.cry,"{rd}":aa.deu,"{wg}":Y.galaxy,"{ws}":Y.system,"{wp}":Y.planet,"{wt}":Y.use?"{I18N."+(Y.type+"").toUpperCase()+"}":0});for(Z in C){X=X.replaceAll("{I18N."+Z+"}",C[Z])}for(Z in k){X=X.replaceAll("{SCRIPT."+Z+"}",k[Z])}for(Z in B){X=X.replaceAll("{COLOR."+Z+"}",B[Z])}return X}};var L=function(U,T){this.jqo=U;if(arguments.length>1){this.val(T)}};L.prototype={val:function(T){if(arguments.length<1){return this.jqo.val()}this.jqo.val(T);return this},disable:function(){this.jqo.attr("disabled","disabled").prop("disabled",true);return this},enable:function(){this.jqo.prop("disabled",false).removeAttr("disabled");return this},isDisabled:function(){return(this.jqo.attr("disabled")=="disabled")}};var I=function(U,T){this.jqo=U;if(arguments.length>1){this.val(T)}};I.prototype=f.extend({},L.prototype,{val:function(T){if(arguments.length<1){return this.isChecked()}if(T){this.check()}else{this.uncheck()}return this},check:function(){this.jqo.attr("checked","checked").prop("checked",true);return this},uncheck:function(){this.jqo.prop("checked",false).removeAttr("checked");return this},isChecked:function(){return(this.jqo.attr("checked")=="checked")}});var u=function(Y,X,V,W){var Z=this,T=(Z.jqo=Y),U;Z.value=X;Z.regExp=V;Z.clearOnFocus=W;Z.allowEmpty=true;Z.onChange=r;if(arguments.length>4){if(arguments.length>5){Z.allowEmpty=arguments[4];Z.onChange=arguments[5]}else{if(typeof(arguments[4])=="function"){Z.onChange=arguments[4]}else{Z.allowEmpty=(arguments[4]&&true)}}}U=function(){var ac=T.val(),aa=ac.length;i.console.log(Z.regExp,'"'+ac+'"',Z.regExp.test(ac));if(Z.allowEmpty||aa>0){if(Z.regExp.test(ac)){Z.value=ac.trim()}else{var ad=T.caret(),ae=aa-ad.start,ab=aa-ad.end;aa=Z.value.length;ae=Math.max(Math.min(aa-ae,aa),0);ab=Math.max(Math.min(aa-ab,aa),0);T.val(Z.value);T.caret(ae,ab)}Z.onChange()}};T.val(X).keyup(U).change(U).blur(function(){T.val(Z.value)}).focus(function(){if(Z.clearOnFocus){if(Z.allowEmpty){Z.val("")}else{T.val("")}}})};u.prototype=f.extend({},L.prototype,{val:function(T){if(arguments.length<1){return this.value}this.jqo.val(this.value=T);return this}});var A=function(Z,Y,X,W){var aa=this,T=(this.jqo=Z),V,U=X;this.allow0=true;this.focused=false;this.onChange=r;this.clearOnFocus=W;U=X.substring(0,1).toUpperCase();if(this.typePercent=(U=="P")){U="F"}this.formatFunc=E["format"+U];this.parseFunc=E["parse"+U];if(arguments.length>4){if(arguments.length>5){this.allow0=arguments[4];this.onChange=arguments[5]}else{if(typeof(arguments[4])=="function"){this.onChange=arguments[4]}else{this.allow0=(arguments[4]&&true)}}}this.set(Y);V=function(){var af=aa.jqo,ad=af.val(),ae=af.caret(),ab=ad.length,ag=ab-ae.start,ac=ab-ae.end;ad=aa.formatFunc(af.val(),true);ab=ad.length;ag=Math.max(Math.min(ab-ag,ab),0);ac=Math.max(Math.min(ab-ac,ab),0);num=(ad=="")?0:aa.parseFunc(ad);if(aa.allow0||num>0){aa.set(ad,true).onChange(aa)}af.caret(ag,ac)};T.keyup(function(ab){if(!(/^9|16$/.test(ab.which+""))){V()}}).change(V).blur(function(){aa.set(aa.num);aa.focused=false}).focus(function(){aa.focused=true;var ad=f(this);if(aa.clearOnFocus||aa.num==0){ad.val("")}else{var ac=ad.caret(),ab=ad.val().length;ad.val(aa.formatFunc(aa.num,true));if(ac.end==ab){if(ac.start==ab){ac.start=(--ac.end)}else{ac.end--}}ab=ad.val().length;ad.caret(Math.min(Math.max(0,ac.start),ab),Math.min(Math.max(0,ac.end),ab))}}).mouseenter(function(){if(R.data.overUnabb&&!(aa.typePercent||aa.focused||aa.clearOnFocus)){var ab=aa.jqo;ab.val(aa.formatFunc(aa.num,true));if(ab.val()==""){ab.val(0)}}}).mouseleave(function(){if(R.data.overUnabb&&!(aa.typePercent||aa.focused||aa.clearOnFocus)){aa.jqo.val(aa.txt)}})};A.prototype=f.extend({},L.prototype,{set:function(W,V){var T,U=(arguments.length>1&&V);if(typeof(W)=="string"){T=(W+"").replace(/\%$/,"");this.num=(T=="")?0:this.parseFunc(T);this.txt=this.formatFunc(this.num)+(this.typePercent?"%":"")}else{this.num=W;this.txt=(T=this.formatFunc(W))+(this.typePercent?"%":"")}this.jqo.val(U?T:this.txt);return this}});var s=function(U,T){var V=this;V.jqo=U;V.val(T);V.jqo.mouseenter(function(){V._mouseenter()}).mouseleave(function(){V._mouseleave()})};s.prototype={val:function(T){if(arguments.length>0){this.jqo.text(E.formatI(T));this.num=T;return this}return this.jqo.text()},_mouseenter:function(){if(R.data.overUnabb&&this.num>0){this.jqo.text(E.formatI(this.num,true))}},_mouseleave:function(){if(R.data.overUnabb){this.jqo.text(E.formatI(this.num))}}};var z=function(X,V){var Y=this,T=(this.jqo=X);this.onChange=V;T.change(function(){Y.set().onChange()});f('<option value="">-</option>').appendTo(T);var W=f('meta[name="ogame-planet-coordinates"]').attr("content").replace(/[^0-9\:]/g,"");var U=f('meta[name="ogame-planet-type"]').attr("content").toLowerCase().trim();f.each(f("#planetList").children("div").get(),function(Z,aa){var ab=f(aa),ac=ab.find(".planet-koords");if(ac.get().length==0){return}ac=ac.text().replace(/[^0-9\:]/g,"");option=f('<option value="planet:'+ac+'">['+ac+"] "+ab.find(".planet-name").text().trim()+"</option>").appendTo(T);if(ac==W&&U=="planet"){Y._setCurrent(option)}if(ab.find(".moonlink").get().length>0){option=f('<option value="moon:'+ac+'">['+ac+"] ("+C.MOON+")</option>").appendTo(T).addClass(l+"moon");if(ac==W&&U=="moon"){Y._setCurrent(option)}}})};z.prototype={use:false,type:0,galaxy:0,system:0,planet:0,set:function(T){var U=((arguments.length>0)?T:this.jqo.val()).split(":");if(U.length<4){this.use=false}else{this.use=true;this.type=U.shift();this.galaxy=U.shift();this.system=U.shift();this.planet=U.shift()}return this},_setCurrent:function(T){T.addClass(l+"highlight").html(T.html()+" &laquo; "+C.CUR_PLA);if(R.data.selCurPla){T.attr("selected","selected")}this.current=T;this.set()},clickCurrent:function(){this.jqo.val(this.current.val()).change()}};var M=function(W,Z,X){var U,T,Y=this,V;if(arguments.length<4){this.isNew=false;this.name=("name" in X)?X.name:(X.id=="MAX")?C.MAX:(X.id=="MIN")?C.MIN:C.REG;this.id=X.id;V=X.ratio}else{this.isNew=true;this.name="*"+C.NEW;V=R.getRatioById(X.defRatio,X).ratio}this.list=W;if(this.isLimit=/^MIN|MAX$/.test(this.id)){this.jqo=f(v.RATIO_LIST_LIMIT).appendTo(W.jqo);this.jqo.find("."+l+"name_noedit").text(this.name)}else{this.jqo=f(this.isNew?v.RATIO_LIST_NEW:v.RATIO_LIST_ITEM).appendTo(W.jqo);this.nameInput=this.jqo.find("."+l+"edit_ratio_name");this.nameInput.change(function(){Y.name=Y.nameInput.val().trim()}).keyup(function(){Y.nameInput.change()}).val(this.name)}this.posLabel=this.jqo.find("."+l+"pos");this.setPos(Z);T=["met","cry","deu"];for(U in T){this[T[U]+"Input"]=new A(this.jqo.find("."+l+"edit_ratio_"+T[U]),V[U],"f",true,false,function(){Y.list.onChange()})}this.addButton=this.jqo.find("."+l+"icon_add").click(function(){var ab=Y.list,aa=new M(ab,Y.pos,Y.getInfo());aa.disableDown().jqo.after(Y.jqo);ab.list[Y.pos]=aa;ab.list[Y.pos-1].enableDown();Y.nameInput.val(Y.name="*"+C.NEW);Y.setPos(++Y.pos)});this.upButton=this.jqo.find("."+l+"icon_up").click(function(){Y.move(true)});this.upDisabled=false;this.downButton=this.jqo.find("."+l+"icon_down").click(function(){Y.move(false)});this.downDisabled=false;this.trashButton=this.jqo.find("."+l+"icon_trash");if(this.isLimit){this.trashButton.addClass("disabled")}else{this.trashButton.click(function(){Y.remove()})}this.radio=this.jqo.find('input[name="'+l+'def_ratio"]').click(function(){Y.list.defRatio=Y.id});if(W.defRatio==this.id){this.radio.click()}this.legal=this.jqo.find("."+l+"legal")};M.prototype={getInfo:function(){var U=this,T={id:U.isNew?H():U.id,ratio:[U.metInput.num,U.cryInput.num,U.deuInput.num]};if((!U.isLimit)&&(U.isNew||U.id!="REG"||U.name!=C.REG)){T.name=U.name}return T},move:function(U){var V,T;if(U){if(this.upDisabled){return this}V=this.list.list[this.pos-1];this.jqo.after(V.jqo)}else{if(this.downDisabled){return this}V=this.list.list[this.pos+1];V.jqo.after(this.jqo)}T=this.pos;this.setPos(V.pos);V.setPos(T);T=V.upDisabled;if(this.upDisabled){V.disableUp()}else{V.enableUp()}if(T){this.disableUp()}else{this.enableUp()}T=V.downDisabled;if(this.downDisabled){V.disableDown()}else{V.enableDown()}if(T){this.disableDown()}else{this.enableDown()}this.list.sortList()},remove:function(){var V,T=[],W=this.list.list,U=this.list.newItem;this.jqo.remove();W.splice(this.pos,1);for(V=0;V<W.length;V++){T[V]=(W[V].setPos(V))}this.list.list=T;if(this.list.defRatio==this.id){T[0].radio.click()}if(this.downDisabled){T[T.length-1].disableDown()}if(this.upDisabled){T[0].disableUp()}U.setPos(U.pos-1)},enableUp:function(){this.upDisabled=false;this.upButton.removeClass("disabled");return this},enableDown:function(){this.downDisabled=false;this.downButton.removeClass("disabled");return this},disableUp:function(){this.upDisabled=true;this.upButton.addClass("disabled");return this},disableDown:function(){this.downDisabled=true;this.downButton.addClass("disabled");return this},setLegal:function(T){if(T){this.legal.text(C.YES).addClass("undermark").removeClass("overmark")}else{this.legal.text(C.NO).addClass("overmark").removeClass("undermark")}return this},setPos:function(T){if(T%2==0){this.jqo.addClass("alt")}else{this.jqo.removeClass("alt")}this.pos=T;this.posLabel.html(this.isNew?"+":T+1);return this}};var y={list:[],limits:[],clear:function(){for(var T in this.list){this.list[T].jqo.remove()}this.list=(this.limits=[]);try{this.newItem.jqo.remove()}catch(U){}},sortList:function(){this.list.sort(function(U,T){return U.pos-T.pos})},build:function(U){var W,X,V=(arguments.length>0)?U:R.data;this.clear();this.defRatio=V.defRatio;for(W=0;W<V.ratioList.length;W++){X=new M(this,W,V.ratioList[W]);this.list[W]=X;if(X.isLimit){this.limits[this.limits.length]=X}}var T=this.list.length;this.newItem=new M(this,T,V,true);this.list[0].disableUp();this.list[T-1].disableDown();this.onChange()},updateData:function(T){var V=(arguments.length>0)?T:R.data;V.ratioList=[];for(var U in this.list){V.ratioList[U]=this.list[U].getInfo()}V.defRatio=this.defRatio},onChangeItem:function(T){if(!T.isLimit){T.setLegal(F.isLegal(T.getInfo().ratio))}},onChange:function(){F.setLimits(this.limits[0].getInfo().ratio,this.limits[1].getInfo().ratio);for(var T=0;T<this.list.length;T++){this.onChangeItem(this.list[T])}this.onChangeItem(this.newItem)},init:function(T){this.jqo=T}};var w=function(U,Y,V,T,X){var W=this;this.list=U;this.iface=X;this.pos=Y;this.title=V.click(function(){W._click()});this.box=T;if(T.hasClass(l+"hidden")){this.setOpen(false)}else{this.setOpen(true)}};w.prototype={updateOpenCss:function(){this.openCss={height:this.box.height()+"px","padding-top":this.box.css("padding-top"),"padding-bottom":this.box.css("padding-bottom"),"margin-top":this.box.css("margin-top"),"margin-bottom":this.box.css("margin-bottom")};return this},closeCss:{height:0,"padding-top":0,"padding-bottom":0,"margin-top":0,"margin-bottom":0},afterOpenCss:{height:"auto"},duration:250,setOpen:function(T){if(this.isOpen=T){this.list.itemOpen=this}return this},open:function(){this.updateOpenCss().box.removeClass(l+"hidden");return this.setOpen(true)},close:function(){this.updateOpenCss().box.addClass(l+"hidden");return this.setOpen(false)},animateOpen:function(){var T=this.afterOpenCss;this.updateOpenCss().box.css(this.closeCss).removeClass(l+"hidden").animate(this.openCss,this.duration,function(){f(this).css(T)});return this.setOpen(true)},animateClose:function(){var T=this;this.updateOpenCss().box.css(this.openCss).animate(this.closeCss,this.duration,function(){f(this).addClass(l+"hidden").css(T.openCss).css(T.afterOpenCss)});return this.setOpen(false)},_click:function(){if(!this.isOpen){this.iface.clearExport();this.list.itemOpen.animateClose();this.animateOpen()}}};var O={init:function(V,W){this.jqo=V;var U,T=[];V.find("."+l+"config_title").each(function(X,Y){T[X]={title:f(Y)}});V.find("."+l+"config_box").each(function(X,Y){T[X].box=f(Y)});this.list=[];for(U=0;U<T.length;U++){this.list[U]=new w(this,U,T[U].title,T[U].box,W)}}};var x=({addCss:function(V){var U=o.createElement("style");U.setAttribute("type","text/css");if(U.styleSheet){U.styleSheet.cssText=V}else{U.appendChild(o.createTextNode(V))}var T=o.getElementsByTagName("head")[0];T.appendChild(U);return this},findIDP:function(T){return this.window.find("#"+l+T)},menuButton:null,menuButtonAction:function(){this.menuButtonAction=function(){};this.makeWindow()},makeMenuButton:function(){var T=this;this.menuButton=f(v.MENUBUTTON).appendTo(f("#menuTableTools")).find("#"+l+"menubutton").click(function(){T.menuButtonAction()});return T},window:null,ogameHide:null,isHidden:true,show:function(){this.isHidden=false;this.ogameHide.hide();this.window.show();return this},hide:function(){this.isHidden=true;this.window.hide();this.ogameHide.show();return this},toggle:function(){if(this.isHidden){return this.show()}return this.hide()},makePlanetSelect:function(){var T=this;T.planet=new z(T.findIDP("planet"),function(){T.onChange()});return T},makeActionSelect:function(){var T=this;T.actionJqo=T.findIDP("action").change(function(){T.action=f(this).val();T.onChange()}).val(T.action=R.data.defAction);return T},makeResourceInput:function(T,U){var V=this;V["input"+T.capitalize()]=new A(V.findIDP("input_"+T),U,"i",false,true,function(){V.checkOutputSelect().onChange()});return V},makeRatioSelect:function(){var T=this;this.ratioSelectJqo=T.findIDP("ratio").change(function(){var U=f(this).val().split(":");if(U.length>3){f(this).val("");T.ratioMet.set(parseFloat(U[1]));T.ratioCry.set(parseFloat(U[2]));T.ratioDeu.set(parseFloat(U[3]));T.checkRatio().onChange()}});return T.updateRatioSelect()},updateRatioSelect:function(){var U,T=this.ratioSelectJqo.html("").append(f('<option value="">-</option>'));for(U in R.data.ratioList){ratio=R.getRatio(U);T.append(f('<option value="'+ratio.val+'">'+E.formatF(ratio.met)+":"+E.formatF(ratio.cry)+":"+E.formatF(ratio.deu)+" ("+ratio.name+")</option>"))}this.ogameDropDown(T);return this},makeRatioInput:function(T,U){var V=this;V["ratio"+T.capitalize()]=new A(V.findIDP("ratio_"+T),U,"f",true,false,function(){V.checkRatio().onChange()});return V},checkRatio:function(){var T=this;if(J.isLegal(T.ratioMet.num,T.ratioCry.num,T.ratioDeu.num)){T.ratioIllegal.hide()}else{T.ratioIllegal.show()}return T},makePercentInput:function(T){var V=this,U="percent"+T.capitalize();V[U]=new A(V.findIDP("percent_"+T),0,"p",false,true,function(Y){if(Y.num>100){Y.set(100,true)}var W="percentMet",X;if(/Met|Cry/.test(U)&&(!V.percentDeu.isDisabled())){W="percentDeu"}else{if(/Met|Deu/.test(U)&&(!V.percentCry.isDisabled())){W="percentCry"}}X=parseFloat((100-Y.num).toFixed((Y.num+"").split(".").pop().length));V[W].set(X);V.onChange()});return V},checkOutputSelect:function(){var Y=this,ab=Y.outputJqo,W=ab.val(),aa=(Y.inputMet.num>0),X=(Y.inputCry.num>0),V=(Y.inputDeu.num>0),Z=/m/.test(W),U=/c/.test(W),T=/d/.test(W);if(!aa&&!X&&V&&!Z&&!U&&T){ab.val("mc").change()}else{if(!aa&&X&&!V&&!Z&&U&&!T){ab.val("md").change()}else{if(aa&&!X&&!V&&Z&&!U&&!T){ab.val("cd").change()}else{if((!aa&&X&&V)||Z&&((X&&U)||(V&&T))){ab.val("m").change()}else{if((aa&&!X&&V)||U&&((aa&&Z)||(V&&T))){ab.val("c").change()}else{if((aa&&X&&!V)||T&&((aa&&Z)||(X&&U))){ab.val("d").change()}}}}}}return Y},changeOutputSelect:function(T){this.outputJqo.val(T);m=this.percentMet.disable().set(0),c=this.percentCry.disable().set(0),d=this.percentDeu.disable().set(0);if(T=="m"){m.set(100)}else{if(T=="c"){c.set(100)}else{if(T=="d"){d.set(100)}else{if(T=="mc"){m.enable().set(50);c.enable().set(50)}else{if(T=="md"){m.enable().set(50);d.enable().set(50)}else{c.enable().set(50);d.enable().set(50)}}}}}return this},makeOutputSelect:function(){var T=this;this.outputJqo=T.findIDP("output").change(function(){T.changeOutputSelect(f(this).val());T.onChange()});return T},toggleConfigCalc:function(){this.window.toggleClass("config").toggleClass("calc");return this},updateConfigData:function(T){var V=this,U=(arguments.length>0)?T:R.data;y.updateData(U);U.defAction=V.defAction.val();U.defOutput=V.defOutput.val();U.selCurPla=V.selCurPla.val();U.abb=V.abb.val();U.overUnabb=V.overUnabb.val();U.millionAbb=V.millionAbb.val();U.millionKey=V.millionKey.val();U.thousandAbb=V.thousandAbb.val();U.thousandKey=V.thousandKey.val();U.messageTpl=V.messageTpl.val();return V},updateConfigIface:function(T){var V=this,U=(arguments.length>0)?T:R.data;F.setLimits(U);y.build(U);V.defAction.val(U.defAction);V.defOutput.val(U.defOutput);V.selCurPla.val(U.selCurPla);V.abb.val(U.abb);V.overUnabb.val(U.overUnabb);V.millionAbb.val(U.millionAbb);V.millionKey.val(U.millionKey);V.thousandAbb.val(U.thousandAbb);V.thousandKey.val(U.thousandKey);V.messageTpl.val(U.messageTpl);V.ieInput.val("");return V},updateCalcIface:function(){J.setLimits();this.inputMet.set(this.inputMet.num);this.inputCry.set(this.inputCry.num);this.inputDeu.set(this.inputDeu.num);this.updateRatioSelect().checkRatio().onChange();return this},makeConfigButtons:function(){var T=this;T.findIDP("config_but").click(function(){T.toggleConfigCalc()});T.findIDP("config_accept").click(function(){T.updateConfigData();R.save();T.updateCalcIface();T.toggleConfigCalc()});T.findIDP("config_cancel").click(function(){T.updateConfigIface();T.toggleConfigCalc()});T.findIDP("config_default").click(function(){R.remove();T.updateCalcIface();T.updateConfigIface();T.toggleConfigCalc()});return T},makeImportExport:function(){var T=this;T.ieInput=T.findIDP("ie_conf").focus(function(){f(this).select()});T.findIDP("ie_import").click(function(){try{var U=R.parseData(T.ieInput.val());T.updateConfigIface(U)}catch(V){alert(V)}});T.findIDP("ie_export").click(function(){var U=f.extend({},R.data);T.updateConfigData(U);T.ieInput.val("").val(JSON.stringify(U)).select()});return T},makeAbbKey:function(){var T=this;T.abb=new I(T.findIDP("abb"));T.overUnabb=new I(T.findIDP("overUnabb"));T.millionAbb=new u(T.findIDP("millionAbb"),R.data.millionAbb,R.abbRE,true,false);T.thousandAbb=new u(T.findIDP("thousandAbb"),R.data.thousandAbb,R.abbRE,true,false);T.millionKey=new u(T.findIDP("millionKey"),R.data.millionKey,R.keyRE,true,false);T.thousandKey=new u(T.findIDP("thousandKey"),R.data.thousandKey,R.keyRE,true,false);return T},makeMessageTpl:function(){var T=this;T.messageTpl=T.findIDP("messageTpl");T.findIDP("messageTpl_restore").click(function(){T.messageTpl.val(R.getDefaultData().messageTpl)});return T},clearExport:function(){this.ieInput.val("");return this},needUpdate:false,showUpdate:function(){this.needUpdate=true;this.menuButton.addClass("middlemark");try{this.findIDP("main").before(f(v.UPDATE))}catch(T){}},ogameDropDown:function(ab){var Y,X,V,W,Z,T,U,ad,ac=null;try{if(ab.hasClass("dropdownInitialized")){ab.removeClass("dropdownInitialized");V=ab.next(".dropdown");T=V.attr("rel");ac=V.attr("style");V.remove();f("#"+T).remove()}V=f(".dropdown.dropdownList").get();ab.ogameDropDown()}catch(aa){return false}ad={select:ab};U=function(){var af,ae;af=ad.select.val();ae=ad.select.find('[value="'+af+'"]').text();ad.dropdown.attr("data-value",af).text(ae)};W=f(".dropdown.dropdownList").get();for(Y=0;Y<V.length;Y++){V[Y]=f(V[Y])}for(Y=0;Y<W.length;Y++){W[Y]=f(W[Y]);T=W[Y].attr("id");Z=true;for(X=0;X<V.length;X++){if(V[X].attr("id")==T){Z=false;break}}if(Z){ad.dropdown=f('.dropdown [rel="'+T+'"]');if(ac!=null){ad.dropdown.parent().attr("style",ac)}U();ab.change(U);break}}return true},ogameDropDowns:function(){var U,T=this.window.find("select").get();if(!this.ogameDropDown(f(T[0]))){return}for(U=1;U<T.length;U++){this.ogameDropDown(f(T[U]))}},makeWindow:function(){v.init();R.load();J=new S();F=new S();var U=this,T=R.getRatioById(R.data.defRatio);U.ogameHide=f("#inhalt").after(this.window=f(v.WINDOW).hide());if(U.needUpdate){U.showUpdate()}U.addCss(v.CSS).show();U.ratioIllegal=U.findIDP("ratio_illegal").hide();U.outputMessage=U.findIDP("message").click(function(){f(this).select()});U.outputMet=new s(U.findIDP("output_met"),0);U.outputCry=new s(U.findIDP("output_cry"),0);U.outputDeu=new s(U.findIDP("output_deu"),0);U.sendRes=new s(U.findIDP("sendRes"),0);U.sendLC=new s(U.findIDP("sendLC"),0);U.sendSC=new s(U.findIDP("sendSC"),0);U.receiveRes=new s(U.findIDP("receiveRes"),0);U.receiveLC=new s(U.findIDP("receiveLC"),0);U.receiveSC=new s(U.findIDP("receiveSC"),0);U.findIDP("close").click(function(){U.hide()});U.makeActionSelect().makeResourceInput("met",0).makeResourceInput("cry",0).makeResourceInput("deu",0).makeRatioSelect().makeRatioInput("met",T.met).makeRatioInput("cry",T.cry).makeRatioInput("deu",T.deu).makeOutputSelect().makePercentInput("met").makePercentInput("cry").makePercentInput("deu").changeOutputSelect(R.data.defOutput).makePlanetSelect().checkRatio();U.findIDP("selCurPla_button").click(function(){U.planet.clickCurrent()});U.menuButtonAction=function(){U.toggle()};U.makeImportExport();O.init(U.findIDP("config"),U);y.init(U.findIDP("ratioList"),this);U.defAction=U.findIDP("defAction");U.defOutput=U.findIDP("defOutput");U.selCurPla=new I(U.findIDP("selCurPla"));U.makeAbbKey().makeMessageTpl().makeConfigButtons().updateConfigIface();U.ogameDropDowns();return U},onChange:function(){var U=this,T=t(U.inputMet.num,U.inputCry.num,U.inputDeu.num,U.ratioMet.num,U.ratioCry.num,U.ratioDeu.num,U.percentMet.num,U.percentCry.num,U.percentDeu.num);U.outputMet.val(T.met);U.outputCry.val(T.cry);U.outputDeu.val(T.deu);if(U.action=="buy"){U.sendRes.val(T.met+T.cry+T.deu);U.receiveRes.val(U.inputMet.num+U.inputCry.num+U.inputDeu.num)}else{U.receiveRes.val(T.met+T.cry+T.deu);U.sendRes.val(U.inputMet.num+U.inputCry.num+U.inputDeu.num)}U.sendLC.val(Math.ceil(U.sendRes.num/25000));U.sendSC.val(Math.ceil(U.sendRes.num/5000));U.receiveLC.val(Math.ceil(U.receiveRes.num/25000));U.receiveSC.val(Math.ceil(U.receiveRes.num/5000));U.outputMessage.text(N.make(U.action,{met:U.inputMet.txt,cry:U.inputCry.txt,deu:U.inputDeu.txt,},{met:U.outputMet.val(),cry:U.outputCry.val(),deu:U.outputDeu.val(),},{res:U.sendRes.val(),lc:U.sendLC.val(),sc:U.sendSC.val(),},{res:U.receiveRes.val(),lc:U.receiveLC.val(),sc:U.receiveSC.val(),},{met:U.ratioMet.txt,cry:U.ratioCry.txt,deu:U.ratioDeu.txt,},U.planet));return U},init:function(){return this.makeMenuButton()}}).init();var Q=(typeof(GM_xmlhttpRequest)=="undefined")?function(){f("body").append(f('<script src="'+k.UPDATE_JSONP+'" type="text/javascript" />'))}:function(){GM_xmlhttpRequest({method:"GET",url:k.UPDATE_URL,onload:function(U){var T=U.responseText.split("\n"),V,W=/^\s*\/\/\s*\@version\s+(\d+(?:\.\d+)*)\s*$/;for(V in T){if(W.test(T[V])){return i[l+"onVersionFound"](T[V].replace(W,"$1"))}}}})};var P=Math.floor(H()/1000);var e={defaultData:function(){return{interval:7,noCheck:false,version:k.VERSION,timestamp:0,versionOG:q.VERSION}},load:function(){this.data=h.get("cfu");this.data=f.extend(this.defaultData(),(this.data==null)?{}:this.data)},update:function(T){f.extend(this.data,{timestamp:P,versionOG:q.VERSION,version:(arguments.length>0)?T:this.data.version});h.set("cfu",this.data)},save:function(T){this.data=f.extend(this.defaultData(),this.data,(arguments.length>0)?T:{});h.set("cfu",this.data)}};var G=function(U){var T=U;e.load();if(e.data.noCheck){return e.update(k.VERSION)}if(n(k.VERSION,e.data.version)){e.update();return T()}if((n(e.data.versionOG,q.VERSION))||(P>e.data.timestamp+86400*e.data.interval)){i[l+"onVersionFound"]=function(V){e.update(g(V));if(n(k.VERSION,e.data.version)){T()}};Q()}};setTimeout(function(){G(function(){x.showUpdate()})},1)}
/*! [onDOMContentLoaded] by Dean Edwards & Matthias Miller & John Resig */
;var p=function(){if(arguments.callee.done){return}arguments.callee.done=true;if(b){clearInterval(b)}a()};if(o.addEventListener){o.addEventListener("DOMContentLoaded",p,false)}if(/WebKit/i.test(i.navigator.userAgent)){var b=setInterval(function(){if(/loaded|complete/.test(o.readyState)){p()}},10)}i.onload=p})();