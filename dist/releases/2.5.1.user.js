// ==UserScript==
// @name	   OGame Trade Calculator
// @description    Adds a trade calculator to the OGame interface
// @namespace      http://userscripts.org/users/68563/scripts
// @downloadURL    https://userscripts.org/scripts/source/151002.user.js
// @updateURL      https://userscripts.org/scripts/source/151002.meta.js
// @version	2.5.1
// @include	*://*.ogame.*/game/index.php?*page=*
// ==/UserScript==
/*! OGame Trade Calculator (C) 2012 Elías Grande Cásedas | GNU-GPL | gnu.org/licenses */
(function(){var p,F={VERSION:[2,5,1],ID_PREFIX:(p="o_trade_calc_"),NAME:"OGame Trade Calculator",HOME_URL:"http://userscripts.org/scripts/show/151002",UPDATE_URL:"https://userscripts.org/scripts/source/151002.meta.js",UPDATE_JSONP:"https://dl.dropbox.com/u/89283239/OGame%20Trade%20Calculator/dist/updater.js",DOWNLOAD_URL:"https://userscripts.org/scripts/source/151002.user.js",TESTED_OGAME_VERSION:"5.2.0-beta7"},b=function(e){var S,R=e.split(/\D+/g);for(S in R){R[S]=parseInt(R[S])}return R},z=function(W,V,R){var T,S=W.length,e=V.length,U=Math.min(S,e);for(T=0;T<U;T++){if(W[T]>V[T]){return false}else{if(W[T]<V[T]){return true}}}if(S>e){return false}if(S<e){return true}if(arguments.length>2&&R){return true}return false};var J=window,h,w;try{if(unsafeWindow){J=unsafeWindow}}catch(P){}h=J.document;w=J.jQuery;var C={obj:J.localStorage,set:function(R,e){return this.obj.setItem(p+R,JSON.stringify(e))},get:function(R){var e=this.obj.getItem(p+R);return(e==null)?null:JSON.parse(e)},remove:function(e){return this.obj.removeItem(p+e)}};w.getScript("/cdn/js/greasemonkey/version-check.js",function(){J.oGameVersionCheck(F.NAME,F.TESTED_OGAME_VERSION,F.HOME_URL)});
/*! jCaret (C) 2010 C. F. Wong | cloudgen.w0ng.hk | www.opensource.org/licenses/mit-license.php */
(function(S,e,R,T){S.fn.caret=function(ai,ae){var V,Y,ag=this[0],aa=S.browser.msie;if(typeof ai==="object"&&typeof ai.start==="number"&&typeof ai.end==="number"){V=ai.start;Y=ai.end}else{if(typeof ai==="number"&&typeof ae==="number"){V=ai;Y=ae}else{if(typeof ai==="string"){if((V=ag.value.indexOf(ai))>-1){Y=V+ai[e]}else{V=null}}else{if(Object.prototype.toString.call(ai)==="[object RegExp]"){var af=ai.exec(ag.value);if(af!=null){V=af.index;Y=V+af[0][e]}}}}}if(typeof V!="undefined"){if(aa){var ab=this[0].createTextRange();ab.collapse(true);ab.moveStart("character",V);ab.moveEnd("character",Y-V);ab.select()}else{this[0].selectionStart=V;this[0].selectionEnd=Y}this[0].focus();return this}else{if(aa){var ad=document.selection;if(this[0].tagName.toLowerCase()!="textarea"){var W=this.val(),Z=ad[R]()[T]();Z.moveEnd("character",W[e]);var ah=(Z.text==""?W[e]:W.lastIndexOf(Z.text));Z=ad[R]()[T]();Z.moveStart("character",-W[e]);var ac=Z.text[e]}else{var Z=ad[R](),U=Z[T]();U.moveToElementText(this[0]);U.setEndPoint("EndToEnd",Z);var ah=U.text[e]-Z.text[e],ac=ah+Z.text[e]}}else{var ah=ag.selectionStart,ac=ag.selectionEnd}var X=ag.value.substring(ah,ac);return{start:ah,end:ac,text:X,replace:function(aj){return ag.value.substring(0,ah)+aj+ag.value.substring(ac,ag.value[e])}}}}})(w,"length","createRange","duplicate");
/*! [/jCaret] */
String.prototype.replaceAll=function(e,R){return this.split(e).join(R)};String.prototype.recursiveReplaceMap=function(U,T,R){if(R==0){return this.split(U[0]).join(T[0])}var S,e=this.split(U[R]);for(S in e){e[S]=e[S].recursiveReplaceMap(U,T,R-1)}return e.join(T[R])};String.prototype.replaceMap=function(e){var R,U,T,S;U=new Array();T=new Array();S=0;for(R in e){U.push(R);T.push(e[R]);S++}if(S==0){return this}else{return this.recursiveReplaceMap(U,T,S-1)}};String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)};String.prototype.trim=function(){return this.replace(/^\s+/,"").replace(/\s+$/,"")};var g=({getMeta:function(R,S){try{return w('meta[name="'+R+'"]').attr("content")}catch(T){if(arguments.length>1){return S}else{return null}}},getResource:function(T){var S=this,e={NAME:"",AMOUNT:0,getName:function(V){var U=this.NAME+"";S[V]=this.AMOUNT+0;return U}};var R=w("#"+T).attr("title");e.NAME=R.split(":").shift();e.AMOUNT=parseInt(R.split("/tr").shift().replace(/\D/g,""));return e},init:function(){return{LANGUAGE:this.getMeta("ogame-language",""),VERSION:b(this.getMeta("ogame-version","0")),RES_MET:this.getResource("metal_box"),RES_CRY:this.getResource("crystal_box"),RES_DEU:this.getResource("deuterium_box")}}}).init();var y={
/*! [colors] */
MET:"#FF7700",CRY:"#00FFFF",DEU:"#FF33FF",SC:"#FFFFFF",LC:"#FFFFFF"
/*! [/colors] */
};var i=({text:{RES_MET:g.RES_MET.getName("RES_MET"),RES_CRY:g.RES_CRY.getName("RES_CRY"),RES_DEU:g.RES_DEU.getName("RES_DEU")},set:function(e,R){if(e.test(g.LANGUAGE)){w.extend(true,this.text,R)}return this}}
/*! [i18n=en] */
).set(/.*/,{THO_SEP:",",DEC_SEP:".",MENU:"Trade C.",TITLE:"Trade calculator",CONFIG:"Settings",UPD_AVA:"Update available",INSTALL:"Install",GO_HOME:"Visit the site of the script",ACTION:"Action",BUY:"I buy",SELL:"I sell",RATIO:"Ratio",ILLEGAL:"illegal",MAX:"Maximum",REG:"Regular",MIN:"Minimum",IN_EXCH:"In exchange for",RESULT:"Result",SEND:"I send",RECEIVE:"I receive",RES:"Resources",LC_SHIP:"LC",SC_SHIP:"SC",OR:"or",MESSAGE:"Message",WHERE:"Place of delivery",PLANET:"Planet",MOON:"Moon",CUR_PLA:"Current planet",SEL_CUR:"Select current planet or moon",RAT_LST:"Ratio list",NAME:"Name",LEGAL:"Legal",YES:"Yes",NO:"No",DEFAULT:"Default",NEW:"New",DEF_VAL:"Default values",ABB_KEY:"Abbreviations and auto-complete keys",USE_ABB:"Use abbreviations when possible",UNABB:"Unabbreviate fields when the mouse is over them",ABB_MIL:"Abbreviation for millions",ABB_THO:"Abbreviation for thousands",KEY_MIL:"Key to write millions (6 zeros)",KEY_THO:"Key to write thousands (3 zeros)",MES_TPL:"Message template",RES_DTP:"Restore default template",IE_CONF:"Import / Export configuration",IMPORT:"Import",EXPORT:"Export",ACCEPT:"Accept",CANCEL:"Cancel",RES_DEF:"Restore default settings",CONTACT:"Contact information"}
/*! [i18n=es] */
).set(/es|ar|mx/,{THO_SEP:".",DEC_SEP:",",MENU:"C. Comercio",TITLE:"Calculadora de comercio",CONFIG:"Configuración",UPD_AVA:"Actualización disponible",INSTALL:"Instalar",GO_HOME:"Visitar página del script",ACTION:"Acción",BUY:"Compro",SELL:"Vendo",RATIO:"Ratio",ILLEGAL:"ilegal",MAX:"Máximo",REG:"Normal",MIN:"Mínimo",IN_EXCH:"A cambio de",RESULT:"Resultado",SEND:"Envío",RECEIVE:"Recibo",RES:"Recursos",LC_SHIP:"NGC",SC_SHIP:"NPC",OR:"o",MESSAGE:"Mensaje",WHERE:"Lugar de entrega",PLANET:"Planeta",MOON:"Luna",CUR_PLA:"Planeta actual",SEL_CUR:"Seleccionar planeta o luna actual",RAT_LST:"Lista de ratios",NAME:"Nombre",LEGAL:"Legal",YES:"Si",NO:"No",DEFAULT:"Por defecto",NEW:"Nuevo",DEF_VAL:"Valores por defecto",ABB_KEY:"Abreviaciones y teclas de autocompletado",USE_ABB:"Usar abreviaciones cuando sea posible",UNABB:"Desabreviar campos al poner el ratón encima",ABB_MIL:"Abreviación para millones",ABB_THO:"Abreviación para miles",KEY_MIL:"Tecla para escribir millones (6 ceros)",KEY_THO:"Tecla para escribir miles (3 ceros)",MES_TPL:"Plantilla de mensaje",RES_DTP:"Restaurar plantilla por defecto",IE_CONF:"Importar / Exportar configuración",IMPORT:"Importar",EXPORT:"Exportar",ACCEPT:"Aceptar",CANCEL:"Cancelar",RES_DEF:"Restaurar ajustes por defecto",CONTACT:"Información de contacto"}
/*! [i18n=nl] by sanctuary http://userscripts.org/users/431052 */
).set(/nl/,{THO_SEP:",",DEC_SEP:".",MENU:"Trade C.",TITLE:"Trade calculator",CONFIG:"Instellingen",UPD_AVA:"Update beschikbaar",INSTALL:"Installeren",GO_HOME:"Bezoek de web van het script",ACTION:"Actie",BUY:"Ik koop",SELL:"Ik verkoop",RATIO:"Verhouding",ILLEGAL:"illegaal",MAX:"Maximaal",REG:"Gemiddeld",MIN:"Minimaal",IN_EXCH:"In ruil voor",RESULT:"Resultaat",SEND:"Ik verstuur",RECEIVE:"Ik ontvang",RES:"Grondstoffen",LC_SHIP:"GV",SC_SHIP:"KV",OR:"of",MESSAGE:"Bericht",WHERE:"Plaats van levering",PLANET:"Planeet",MOON:"Maan",CUR_PLA:"Huidige planeet",SEL_CUR:"Kies huidige planeet of maan",RAT_LST:"Verhouding lijst",NAME:"Naam",LEGAL:"Legaal",YES:"Ja",NO:"Nee",DEFAULT:"Standaard",NEW:"Nieuw",DEF_VAL:"Standaard waarde",ABB_KEY:"Toets afkortingen en automatisch aanvullen",USE_ABB:"Gebruik afkortingen wanneer mogelijk",UNABB:"Verkort velden wanneer de muis over het veld staat",ABB_MIL:"Afkorting voor miljoen",ABB_THO:"Afkorting voor duizend",KEY_MIL:"Toets voor miljoen te schrijven (6 nullen)",KEY_THO:"Toets voor duizend te schrijven (3 nullen)",MES_TPL:"Bericht sjabloon",RES_DTP:"Herstel standaard sjabloon",IE_CONF:"Invoer / Uitvoer configuratie",IMPORT:"Invoer",EXPORT:"Uitvoer",ACCEPT:"Accepteer",CANCEL:"Annuleer",RES_DEF:"Herstel naar standaard instellingen",CONTACT:"Contactinformatie"}
/*! [/i18n] */
).text;var k={
/*! [css] */
CSS:"#"+p+"window select{visibility:visible !important;}#"+p+"window{float:left;position:relative;width:670px;overflow:visible;z-index:2;}#galaxy #"+p+"window{top:-44px;}#"+p+'header{height:28px;position: relative;background: url("http://gf1.geo.gfsrv.net/cdn63/10e31cd5234445e4084558ea3506ea.gif") no-repeat scroll 0px 0px transparent;}#'+p+"header h4{height:28px;line-height:28px;text-align:center;color:#6F9FC8;font-size:12px;font-weight:bold;position:absolute;top:0;left:100px;right:100px;}#"+p+"config_but{display:block;height:16px;width:16px;background:url(http://gf3.geo.gfsrv.net/cdne7/1f57d944fff38ee51d49c027f574ef.gif);float:right;margin:8px 0 0 0;opacity:0.5;}#"+p+"config_but:hover{opacity:1;}#"+p+'window.config input[type="button"]{margin:0 5px 0 5px;}#'+p+"config,#"+p+"window.config #"+p+"calc,#"+p+"window.config #"+p+"config_but,#"+p+"window.calc ."+p+"config_only{display:none;}#"+p+"window.config #"+p+"config{display:block;}#"+p+"main,#"+p+'update{padding:15px 25px 0 25px;background: url("http://gf1.geo.gfsrv.net/cdn9e/4f73643e86a952be4aed7fdd61805a.gif") repeat-y scroll 5px 0px transparent;}#'+p+"main *{font-size:11px;}#"+p+"update div{font-size:11px;border:1px solid #000;color:#99CC00;line-height:30px;text-align:center;font-weight:bold;}#"+p+"update a{margin-left:15px;}#"+p+"window table{width:620px;background-color:#0D1014;border-collapse:collapse;clear:both;}#"+p+"window.calc table{border:1px solid #000;margin:0 0 20px 0;}#"+p+"window.calc table.last{margin:0;}#"+p+"window.config table{width:598px;}#"+p+"main th{color:#6F9FC8;text-align:center;font-weight:bold;}."+p+"label,."+p+"label *{color:grey;text-align:left;}."+p+"label{padding:0 5px 0 5px;font-weight:bold;}#"+p+"window.config ."+p+"label{text-align:center;}#"+p+"main tr,#"+p+"main td,#"+p+"main th{height:28px;line-height:28px;}#"+p+'main input[type="text"]{width:100px;text-align:center;}option.'+p+"highlight{color:lime !important;font-weight:bold;}option."+p+"moon{color:orange;}."+p+"select{width:150px;text-align:left;}."+p+"select select{width:130px;text-align:center;}#"+p+"main option{padding:1px 5px 1px 5px;}."+p+"input,."+p+"output{width:112px;padding:0 2px 0 0;}."+p+"name{width:142px;padding:0 1px 0 1px;text-align:right;}#"+p+"main ."+p+"name input{width:130px;text-align:center;}."+p+"ratio{width:82px;padding:0 1px 0 1px;text-align:right;}#"+p+"main ."+p+"ratio input{width:70px;text-align:center;}#"+p+"ratio_illegal{color:red;}."+p+"output{text-align:center;font-weight:bold;}#"+p+"output_met{color:"+y.MET+";}#"+p+"output_cry{color:"+y.CRY+";}#"+p+"output_deu{color:"+y.DEU+";}."+p+"textarea{padding:0 3px 0 3px !important;}#"+p+"message{width:601px;height:50px !important;margin:0 !important;}#"+p+"planet{width:auto;text-align:left;margin:0;}."+p+"select1row{padding-left:2px;}."+p+"select1row select{width:250px !important;text-align:left;margin:0;}#"+p+"selCurPla_button{margin-left:30px}#"+p+'footer{height:17px;background: url("http://gf1.geo.gfsrv.net/cdn30/aa3e8edec0a2681915b3c9c6795e6f.gif") no-repeat scroll 2px 0px transparent;}.'+p+'config_title{font-size:11px;font-weight:bold;color:#6F9FC8;line-height:22px;background:url("http://gf1.geo.gfsrv.net/cdn0b/d55059f8c9bab5ebf9e8a3563f26d1.gif") no-repeat scroll 0 0 #13181D;height:22px;margin:0 0 10px 0;padding:0 0 0 40px;border:1px solid #000;overflow:hidden;cursor:pointer;}.'+p+"config_title:hover{color:#A7AFB7;background-color:#23282D;border-color:#13181D;}."+p+"config_box{border:1px solid #000;margin:5px 5px 10px 5px;padding:5px;}#"+p+"new_ratio input{border-color:#9C0;}."+p+"check,."+p+"name_noedit{text-align:center;}."+p+"check input{vertical-align:text-bottom;}."+p+'check input[type="checkbox"]{vertical-align:middle;}.'+p+"action{text-align:center;padding:0 3px 0 3px;}."+p+'action a{background:url("http://gf1.geo.gfsrv.net/cdn94/297ee218d94064df0a66bd41a04d28.png") scroll 0 0 no-repeat;width:16px;height:16px;display:inline-block;vertical-align:top;position:relative;top:5px;border:1px solid #000;border-radius:2px;opacity:0.7;}a.'+p+"icon_up,a."+p+"icon_down,a."+p+"icon_add{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAwCAMAAAAvgQplAAAAAXNSR0IArs4c6QAAAvpQTFRFbomeXHaLb4mdgpyveJaxdpSweZKk////W3qXVnKNRWB6AAAANTU1PT09MUJTJzVD/6gAzAAA/9IA/wAAqsrjvtjrna25PlVsTWiCqbjESGF6YHyaOk9ldZOwTWeCPj4+PlRsVHeYRGKBUXCRQVx6VnibTGmFVnmbRWOERWSEXn+chJusPVhzU3SVQ19+TGyKU3aXPVRrTGqHkrHKPVZwUW6KQ2GAU3aZO09lcJCqYHqORV95UW6LTGeBQFlySGB5SmF6Q2B+VnmaUG2JVnSQS2qHSmeCL0RaXHmUU3WVoLzSqcTYQ2GCPFZxPVZxkaa1RWSDPFZyRl96XH2ZTGqGS2qJO1Ru1d7lV3SROk5kQVp0QVpz5erua4OWqLnGpcDUWn2ewMzVlK/EqLbCcY+qj6zESmF3r7zHob3TTGaAlqi2haO9XniNQ115TWiD8vX4k7DGZ4mqyNTdSmaBpcHWcImdjaKynbrRdY6hvMnTSWeHYXyaq7jDV3SQ6+/zo7/Ur8rd8PP1javGhaK82uLmq8bZq7vHh6a+0NrgnLjOhJqqUG+QpL/VsL7JdJOuXnmSytTcj6OxT2qE+Pn7eZm0zCszfZmxhqXBdZGpXHaOS2uKboynr73J4ebrhKO7obLAmLfR+vv9nLfNip+uX3yYXn+bdoyec42gobC9pbS/yNPbYX2aPVRtt8XPmLTLbo2odI2geI2fVHKT2OHo3OLoRGGBRmODkK7HaImkaomka4unjaCw/f7/mbjRXnyXd4+jf5Wmp8HWjq3IiqnEeZOqPlVtVHeXYH2ai6CxYYCbZIKfZn+TTGeDVnWQb5GtVnWRSWWASmWATGuKc5CpusXOU3GQlLPMXHqXUnSUZoSifJq0fJu3ZHyT/v//dpOwqcXZYHqSYnuQ7fDz7PD0XHyYWnaRkKW1TGiFTGmEj6zDYXuPPFdzPVdzrsndhpytVHaYh52uXn6c8PP2jqzFQFt5jKvFcYqeQl99gZ+52uHmRGKAyNTcV3iaqsbZDVW+rgAAAAF0Uk5TAEDm2GYAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH3AsJFTcNV6u1fQAAAE9JREFUKM/dkjEOACAIA6tL//9jFaORqhtxsBO9CS4AyQXSKwkEpAfkIMgttNh4AUtCALQ/9NGPu4A87/erj/6DD30HBZuPwztsPmIFqY8CjdEFo21taJsAAAAASUVORK5CYII=);}a."+p+"icon_down{background-position:0px -16px}a."+p+"icon_add{background-position:0px -32px}."+p+"action a:hover{opacity:1;border-color:#08090b;}."+p+"action a.disabled,."+p+"action aldisabled:hover{opacity:0.1;cursor:default;}a."+p+"icon_trash{background-position:0px -304px}#"+p+"window.config .undermark,#"+p+"window.config .overmark{font-weight:bold;text-align:center;}#"+p+"window.config textarea{display:block;width:586px;margin:0 0 5px 0;}."+p+"ie_conf{text-align:center}."+p+"hidden{position:fixed;left:-10000px;}."+p+"fieldwrapper:before,."+p+'fieldwrapper:after{content:"";display:table;}.'+p+"fieldwrapper:after{clear:both;}."+p+"fieldwrapper{padding:7px 0 7px 0;}."+p+"fieldwrapper label,."+p+"thefield{color:#6F9FC8;height:22px;line-height:22px;float:left;margin:2px 0 0 0;}."+p+"fieldwrapper label{font-weight:bold;width:320px;margin:0 15px 0 0;padding:0 0 0 10px;}."+p+'thefield input[type="text"],.'+p+"thefield select{width:200px}",
/*! [tpl=action_options] */
ACTION_OPT:'<option value="sell">'+i.SELL+'</option><option value="buy">'+i.BUY+"</option>",
/*! [tpl=output_options] */
OUTPUT_OPT:'<option value="m">'+i.RES_MET+'</option><option value="c">'+i.RES_CRY+'</option><option value="d">'+i.RES_DEU+'</option><option value="mc">'+i.RES_MET+" + "+i.RES_CRY+'</option><option value="md">'+i.RES_MET+" + "+i.RES_DEU+'</option><option value="cd">'+i.RES_CRY+" + "+i.RES_DEU+"</option>",
/*! [tpl=void_href] */
VOID_HREF:'href="javascript:void(0)"',
/*! [tpl=window] */
WINDOW:'<div id="'+p+'window" class="calc"><div id="'+p+'header"><h4>'+i.TITLE+'<span class="'+p+'config_only"> &raquo; '+i.CONFIG+'</span></h4><a id="'+p+'close" href="javascript:void(0);" class="close_details close_ressources"></a><a id="'+p+'config_but" href="javascript:void(0);"></a></div><div id="'+p+'main"><div id="'+p+'calc"><table cellspacing="0" cellpadding="0"><tbody><tr><th colspan="2"></th><th>'+i.RES_MET+"</th><th>"+i.RES_CRY+"</th><th>"+i.RES_DEU+'</th></tr><tr class="alt"><td class="'+p+'label">'+i.ACTION+'</td><td class="'+p+'select"><select id="'+p+'action">{this.ACTION_OPT}</select></td><td class="'+p+'input"><input id="'+p+'input_met" type="text" value=""></td><td class="'+p+'input"><input id="'+p+'input_cry" type="text" value=""></td><td class="'+p+'input"><input id="'+p+'input_deu" type="text" value=""></td></tr><tr><td class="'+p+'label">'+i.RATIO+'<span id="'+p+'ratio_illegal"> ('+i.ILLEGAL+')</span></td><td class="'+p+'select"><select id="'+p+'ratio"></select></td><td class="'+p+'input"><input id="'+p+'ratio_met" type="text" value=""></td><td class="'+p+'input"><input id="'+p+'ratio_cry" type="text" value=""></td><td class="'+p+'input"><input id="'+p+'ratio_deu" type="text" value=""></td></tr><tr class="alt"><td class="'+p+'label">'+i.IN_EXCH+'</td><td class="'+p+'select"><select id="'+p+'output">{this.OUTPUT_OPT}</select></td><td class="'+p+'input"><input id="'+p+'percent_met" type="text" value=""></td><td class="'+p+'input"><input id="'+p+'percent_cry" type="text" value=""></td><td class="'+p+'input"><input id="'+p+'percent_deu" type="text" value=""></td></tr><tr><td class="'+p+'label" colspan="2">'+i.RESULT+'</td><td class="'+p+'output" id="'+p+'output_met"></td><td class="'+p+'output" id="'+p+'output_cry"></td><td class="'+p+'output" id="'+p+'output_deu"></td></tr></tbody></table><table cellspacing="0" cellpadding="0"><tbody><tr><th></th><th>'+i.RES+"</th><th>"+i.LC_SHIP+"</th><th>"+i.SC_SHIP+'</th></tr><tr class="alt"><td class="'+p+'label">'+i.SEND+'</td><td class="'+p+'output overmark" id="'+p+'sendRes">0</td><td class="'+p+'output" id="'+p+'sendLC">0</td><td class="'+p+'output" id="'+p+'sendSC">0</td></tr><tr><td class="'+p+'label">'+i.RECEIVE+'</td><td class="'+p+'output undermark" id="'+p+'receiveRes">0</td><td class="'+p+'output" id="'+p+'receiveLC">0</td><td class="'+p+'output" id="'+p+'receiveSC">0</td></tr></tbody></table><table cellspacing="0" cellpadding="0"><tbody><tr class="alt"><td class="'+p+'label" colspan="5">'+i.WHERE+'</td></tr><tr class="alt"><td class="'+p+'select1row" colspan="5"><select id="'+p+'planet"></select><a {this.VOID_HREF} id="'+p+'selCurPla_button">'+i.SEL_CUR+'</a></td></tr></tbody></table><table cellspacing="0" cellpadding="0" class="last"><tbody><tr class="alt"><td class="'+p+'label" colspan="5">'+i.MESSAGE+'</td></tr><tr class="alt"><td class="'+p+'textarea" colspan="5"><textarea id="'+p+'message" cols="1" rows="1" readonly="readonly"></textarea></td></tr></tbody></table></div><div id="'+p+'config"><div class="'+p+'config_title">'+i.RAT_LST+'</div><div class="'+p+'config_box"><table cellspacing="0" cellpadding="0"><tbody id="'+p+'ratioList"><tr><th>#</th><th>'+i.NAME+"</th><th>"+i.RES_MET+"</th><th>"+i.RES_CRY+"</th><th>"+i.RES_DEU+"</th><th>"+i.ACTION+"</th><th>"+i.LEGAL+"</th><th>"+i.DEFAULT+'</th></tr></tbody></table></div><div class="'+p+'config_title">'+i.DEF_VAL+'</div><div class="'+p+"config_box "+p+'hidden"><div class="'+p+'fieldwrapper"><label>'+i.ACTION+':</label><div class="'+p+'thefield"><select id="'+p+'defAction">{this.ACTION_OPT}</select></div></div><div class="'+p+'fieldwrapper"><label>'+i.IN_EXCH+':</label><div class="'+p+'thefield"><select id="'+p+'defOutput">{this.OUTPUT_OPT}</select></div></div><div class="'+p+'fieldwrapper"><label>'+i.SEL_CUR+':</label><div class="'+p+'thefield"><input id="'+p+'selCurPla" type="checkbox" /></div></div></div><div class="'+p+'config_title">'+i.ABB_KEY+'</div><div class="'+p+"config_box "+p+'hidden"><div class="'+p+'fieldwrapper"><label>'+i.USE_ABB+':</label><div class="'+p+'thefield"><input id="'+p+'abb" type="checkbox" /></div></div><div class="'+p+'fieldwrapper"><label>'+i.UNABB+':</label><div class="'+p+'thefield"><input id="'+p+'overUnabb" type="checkbox" /></div></div><div class="'+p+'fieldwrapper"><label>'+i.ABB_MIL+':</label><div class="'+p+'thefield"><input id="'+p+'millionAbb" type="text" maxlength="10" /></div></div><div class="'+p+'fieldwrapper"><label>'+i.ABB_THO+':</label><div class="'+p+'thefield"><input id="'+p+'thousandAbb" type="text" maxlength="10" /></div></div><div class="'+p+'fieldwrapper"><label>'+i.KEY_MIL+':</label><div class="'+p+'thefield"><input id="'+p+'millionKey" type="text" maxlength="1" /></div></div><div class="'+p+'fieldwrapper"><label>'+i.KEY_THO+':</label><div class="'+p+'thefield"><input id="'+p+'thousandKey" type="text" maxlength="1" /></div></div></div><div class="'+p+'config_title">'+i.MES_TPL+'</div><div class="'+p+"config_box "+p+'hidden"><textarea id="'+p+'messageTpl"></textarea><div class="textCenter"><input id="'+p+'messageTpl_restore" type="button" value="'+i.RES_DTP+'" class="btn_blue"></div></div><div class="'+p+'config_title">'+i.IE_CONF+'</div><div class="'+p+"config_box "+p+"ie_conf "+p+'hidden"><textarea id="'+p+'ie_conf"></textarea><input id="'+p+'ie_import" type="button" value="'+i.IMPORT+'" class="btn_blue"><input id="'+p+'ie_export" type="button" value="'+i.EXPORT+'" class="btn_blue"></div><div class="'+p+'config_title">'+i.CONTACT+'</div><div class="'+p+"config_box "+p+'hidden"><table cellspacing="0" cellpadding="0"><tbody><tr class="alt"><td class="'+p+"label "+p+'pos">1</td><td>Userscripts</td><td><a href="http://userscripts.org/scripts/discuss/151002" target="_blank">Discuss OGame Trade Calculator - userscripts.org</a></td></tr><tr><td class="'+p+"label "+p+'pos">2</td><td>Ogame Origin</td><td><a href="http://board.origin.ogame.de/board6-origin/board38-tools-scripts-skins/board39-tolerated-tools-addons-scripts/4367-ogame-trade-calculator/" target="_blank">[Tolerated] OGame Trade Calculator - board.origin.ogame.de</a></td></tr><tr class="alt"><td class="'+p+"label "+p+'pos">3</td><td>Ogame España</td><td><a href="http://board.ogame.com.es/board859-ogamelacomunidad/board860-comunidad/board422-utilidadesyskinsparaogame/1224751-scriptcalculadoradecomerciolegal/" target="_blank">[Script] Calculadora de Comercio [Legal] - board.ogame.com.es</a></td></tr></tbody></table></div><div class="textCenter"><input id="'+p+'config_accept" type="button" value="'+i.ACCEPT+'" class="btn_blue"><input id="'+p+'config_cancel" type="button" value="'+i.CANCEL+'" class="btn_blue"><input id="'+p+'config_default" type="button" value="'+i.RES_DEF+'" class="btn_blue"></div></div></div><div id="'+p+'footer"></div></div>',
/*! [tpl=button] */
MENUBUTTON:'<li><a id="'+p+'menubutton" class="menubutton" href="javascript:void(0)" accesskey="" target="_self"><span class="textlabel">'+i.MENU+"</span></a></li>",
/*! [tpl=ratio_list_limit] */
RATIO_LIST_LIMIT:'<tr><td class="'+p+"label "+p+'pos"></td><td class="'+p+'name_noedit"></td><td class="'+p+'ratio"><input class="'+p+'edit_ratio_met" type="text" /></td><td class="'+p+'ratio"><input class="'+p+'edit_ratio_cry" type="text" /></td><td class="'+p+'ratio"><input class="'+p+'edit_ratio_deu" type="text" /></td><td class="'+p+'action"><a {this.VOID_HREF} class="'+p+'icon_up"></a><a {this.VOID_HREF} class="'+p+'icon_down"></a><a {this.VOID_HREF} class="'+p+'icon_trash disabled"></a></td><td class="'+p+'label">-</td><td class="'+p+'check"><input name="'+p+'def_ratio" type="radio" /></td></tr>',
/*! [tpl=ratio_list_item] */
RATIO_LIST_ITEM:'<tr><td class="'+p+"label "+p+'pos"></td><td class="'+p+'name"><input class="'+p+'edit_ratio_name" type="text" /></td><td class="'+p+'ratio"><input class="'+p+'edit_ratio_met" type="text" /></td><td class="'+p+'ratio"><input class="'+p+'edit_ratio_cry" type="text" /></td><td class="'+p+'ratio"><input class="'+p+'edit_ratio_deu" type="text" /></td><td class="'+p+'action"><a {this.VOID_HREF} class="'+p+'icon_up"></a><a {this.VOID_HREF} class="'+p+'icon_down"></a><a {this.VOID_HREF} class="'+p+'icon_trash"></a></td><td class="'+p+'legal"></td><td class="'+p+'check"><input name="'+p+'def_ratio" type="radio" /></td></tr>',
/*! [tpl=ratio_list_new] */
RATIO_LIST_NEW:'<tr id="'+p+'new_ratio"><td class="undermark '+p+'pos"></td><td class="'+p+'name"><input class="'+p+'edit_ratio_name" type="text" /></td><td class="'+p+'ratio"><input class="'+p+'edit_ratio_met" type="text" /></td><td class="'+p+'ratio"><input class="'+p+'edit_ratio_cry" type="text" /></td><td class="'+p+'ratio"><input class="'+p+'edit_ratio_deu" type="text" /></td><td class="'+p+'action"><a {this.VOID_HREF} class="'+p+'icon_add"></a></td><td class="'+p+'legal"></td><td class="'+p+'label">-</td></tr>',
/*! [tpl=update] */
UPDATE:'<div id="'+p+'update"><div>Actualización disponible'+((typeof(GM_xmlhttpRequest)=="undefined")?"":('<a target="_blank" href="'+F.DOWNLOAD_URL+'">Instalar</a>'))+'<a target="_blank" href="'+F.HOME_URL+'">Ir a la página del script</a></div></div>',
/*! [/tpl] */
init:function(){for(var R in this){if(typeof(this[R])=="string"){for(var e in this){if(typeof(this[e])=="string"){this[R]=this[R].replaceAll("{this."+e+"}",this[e])}}}}}};var M=(function(){var e=w('meta[name="ogame-universe"]').attr("content");
/*! [default_ratios] */
return/^\w+\.ogame\.org$/.test(e)?[3,2,1,2,1,1,3,2,1]:[5,3,1,2,1.5,1,3,2,1];
/*! [/default_ratios] */
})();var L=function(){return(new Date()).getTime()};var t=function(){};var A=function(R){R.preventDefault()};var E={getDefaultData:function(){return{
/*! [config=default] */
version:F.VERSION.slice(0),defAction:"sell",ratioList:[{id:"MAX",ratio:[M[0],M[1],M[2]]},{id:"MIN",ratio:[M[3],M[4],M[5]]},{id:"REG",ratio:[M[6],M[7],M[8]]}],defRatio:"REG",defOutput:"m",millionAbb:"M",millionKey:"m",thousandAbb:"K",thousandKey:"k",abb:false,overUnabb:false,selCurPla:false,messageTpl:"[b]{?b}{I18N.BUY}{/b}{?s}{I18N.SELL}{/s}:[/b] {?m}[b][color={COLOR.MET}]{m}[/color][/b] ({I18N.RES_MET}){?cd} + {/cd}{/m}{?c}[b][color={COLOR.CRY}]{c}[/color][/b] ({I18N.RES_CRY}){?d} + {/d}{/c}{?d}[b][color={COLOR.DEU}]{d}[/color][/b] ({I18N.RES_DEU}){/d}\n[b]{I18N.IN_EXCH}:[/b] {?M}[b][color={COLOR.MET}]{M}[/color][/b] ({I18N.RES_MET}){?CD} + {/CD}{/M}{?C}[b][color={COLOR.CRY}]{C}[/color][/b] ({I18N.RES_CRY}){?D} + {/D}{/C}{?D}[b][color={COLOR.DEU}]{D}[/color][/b] ({I18N.RES_DEU}){/D}\n\n[b]* {I18N.SEND}:[/b] {sr} ({I18N.RES}) = [b][color={COLOR.LC}]{sl}[/color][/b] ({I18N.LC_SHIP}) {I18N.OR} [b][color={COLOR.SC}]{ss}[/color][/b] ({I18N.SC_SHIP})\n[b]* {I18N.RECEIVE}:[/b] {rr} ({I18N.RES}) = [b][color={COLOR.LC}]{rl}[/color][/b] ({I18N.LC_SHIP}) {I18N.OR} [b][color={COLOR.SC}]{rs}[/color][/b] ({I18N.SC_SHIP})\n\n[b]* {I18N.RATIO}:[/b] {rm}:{rc}:{rd}{?w}\n[b]* {I18N.WHERE}:[/b] {wg}:{ws}:{wp} ({wt}){/w}\n\n[b][url={SCRIPT.HOME_URL}]{SCRIPT.NAME}[/url][/b]"
/*! [/config] */
}},abbRE:/^\S+$/,keyRE:/^\S$/,_error:function(e){throw"DataError: "+e},_errorUndefined:function(e){this._error(e+" is undefined")},_errorExpected:function(R,S,T,U){var W,V=T+"";if(/^[\<\>]\d+$/.test(V)){if(V.charAt(0)==">"){W="greater"}else{W="less"}W+=" than "+V.slice(1)}else{W='"'+V.split(":").join(" or ")+'"'}this._error(R+": "+S+" "+W+' expected but "'+U+'" found')},_errorType:function(e,R,S){if(S=="undefined"){this._errorUndefined(e)}else{this._errorExpected(e,"type",R,S)}},_errorValue:function(e,R,S){this._errorExpected(e,"value",R,S)},_errorValueRE:function(e,R,S){this._error(e+': value "'+S+'" doesn\'t match the expected RegExp "'+R+'"')},_errorLength:function(e,R,S){this._errorExpected(e,"length",R,S)},parseData:function(R){var S,e,aa,T=this,U=(typeof(R)=="string")?JSON.parse(R):R,ab="boolean",Z="string",V="number";if((aa=typeof(U.defAction))!=Z){T._errorType("defAction",Z,aa)}if(typeof(U.ratioList)=="undefined"){T._errorUndefined("ratioList")}if(!(/^sell|buy$/.test(U.defAction))){T._errorValue("defAction","sell:buy",U.defAction)}aa=typeof(U.defRatio);if(!(/^number|string$/.test(aa))){T._errorType("defRatio",Z+":"+V,aa)}var W=true,X=true,Y=true;for(S=0;S<U.ratioList.length;S++){e=U.ratioList[S];if((aa=e.ratio.length)!=3){T._errorLength("ratioList["+S+"]",3,aa)}if((e.ratio[0]+=0)<=0){T._errorValue("ratioList["+S+"].ratio[0]",">0",e.ratio[0])}if((e.ratio[1]+=0)<=0){T._errorValue("ratioList["+S+"].ratio[1]",">0",e.ratio[1])}if((e.ratio[2]+=0)<=0){T._errorValue("ratioList["+S+"].ratio[2]",">0",e.ratio[2])}if(e.id==U.defRatio){Y=false}if(/^MAX|MIN|REG$/.test(e.id+"")){if(e.id=="MAX"){W=false}else{if(e.id=="MIN"){X=false}}}else{if((aa=typeof(e.id))!=V){T._errorType("ratioList["+S+"].id",V,aa)}if((aa=typeof(e.name))!=Z){T._errorType("ratioList["+S+"].name",Z,aa)}}}if(W){T._error('ratioList: maximum ratio (id="MAX") not found')}if(X){T._error('ratioList: minimum ratio (id="MIN") not found')}if(Y){T._error('ratioList: default ratio (id="'+U.defRatio+'" == defRatio) not found')}e=U.ratioList.slice(0).sort();for(S=1;S<e.length;S++){if(e[S-1].id==e[S].id){T._error('ratioList: duplicate id "'+e[S].id+'" found')}}if(!(/^m|c|d|mc|md|cd$/.test(U.defOutput))){T._errorValue("defOutput","m:c:d:mc:md:cd",U.defOutput)}if((aa=typeof(U.millionAbb))!=Z){T._errorType("millionAbb",Z,aa)}if((aa=U.millionAbb.length)<1){T._errorLength("millionAbb",">0",aa)}if(!T.abbRE.test(aa=U.millionAbb)){T._errorValueRE("millionAbb",T.abbRE,aa)}if((aa=typeof(U.millionKey))!=Z){T._errorType("millionKey",Z,aa)}if((aa=U.millionKey.length)!=1){T._errorLength("millionKey",1,aa)}if(!T.keyRE.test(aa=U.millionKey)){T._errorValueRE("millionKey",T.keyRE,aa)}if((aa=typeof(U.thousandAbb))!=Z){T._errorType("thousandAbb",Z,aa)}if((aa=U.thousandAbb.length)<1){T._errorLength("thousandAbb",">0",aa)}if(!T.abbRE.test(aa=U.thousandAbb)){T._errorValueRE("thousandAbb",T.abbRE,aa)}if((aa=typeof(U.thousandKey))!=Z){T._errorType("thousandKey",Z,aa)}if((aa=U.thousandKey.length)!=1){T._errorLength("thousandKey",1,aa)}if(!T.keyRE.test(aa=U.thousandKey)){T._errorValueRE("thousandKey",T.keyRE,aa)}if((aa=typeof(U.abb))!=ab){T._errorType("abb",ab,aa)}if((aa=typeof(U.overUnabb))!=ab){T._errorType("overUnabb",ab,aa)}if((aa=typeof(U.selCurPla))!=ab){T._errorType("selCurPla",ab,aa)}if((aa=typeof(U.messageTpl))!=Z){T._errorType("messageTpl",Z,aa)}return U},getRatio:function(R,U){var T=(arguments.length>1)?U.ratioList[R]:this.data.ratioList[R],V=T.id+"",e,S=T.ratio.slice(0);if("name" in T){e=T.name+""}else{e=i[V]}return{id:V,ratio:S,name:e,val:V+":"+S[0]+":"+S[1]+":"+S[2],met:S[0],cry:S[1],deu:S[2]}},getRatioById:function(U,S){var e,T=(arguments.length>1)?S:this.data,R=T.ratioList;for(e in R){if(R[e].id==U){return this.getRatio(e,T)}}return null},updateVersion:function(V){var e=(typeof(V.version)=="undefined")?0:V.version,R,U=this.getDefaultData();if(z(e,[2,4])){V.messageTpl=U.messageTpl}if(z(e,[2,5])){var T=V.ratioList,S=false;for(R in T){if(T[R].id=="MAX"){break}}if(R<T.length||T[R].ratio.join(":")=="5:3:1"){T[R].ratio=this.getRatioById("MAX",U).ratio}}V.version=U.version;for(R in U){if(typeof(V[R])=="undefined"){V[R]=U[R]}}return V},save:function(e){if(arguments.length>0){this.data=e}this.data=this.updateVersion(this.data);C.set("config",this.data);return this},load:function(){var e=C.get("config");if(e==null){this.data=this.getDefaultData()}else{this.save(e)}return this},remove:function(){C.remove("config");this.data=this.getDefaultData()}};var H={formatI:function(U,S){var T,e=(arguments.length>1&&S);if(e&&U==""){return""}if(typeof(U)=="string"){T=("0"+U+"").replace(new RegExp(E.data.thousandKey+"$","i"),"000").replace(new RegExp(E.data.millionKey+"$","i"),"000000").replace(/\D/g,"").replace(/^0+(\d)/,"$1")}else{T=U.toFixed()+""}var R=/(\d+)(\d{3})/;while(R.test(T)){T=T.replace(R,"$1"+i.THO_SEP+"$2")}if(!e&&E.data.abb){return T.replace(/\D000\D000$/,E.data.millionAbb).replace(/\D(\d*[1-9]+)0*\D000$/,i.DEC_SEP+"$1"+E.data.millionAbb).replace(/\D000$/,E.data.thousandAbb)}return T},formatF:function(X,V){var W,e,U,S,R=(arguments.length>1&&V);if(R&&X==""){return""}if(typeof(X)=="string"){W=("0"+X+"").replace(/[\.\,]$/,i.DEC_SEP).replace(new RegExp("[^0-9\\"+i.DEC_SEP+"]","g"),"").replace(/^0+(\d)/,"$1")}else{W=(X+"").replace(".",i.DEC_SEP)}e=W.split(i.DEC_SEP);U=e[0];S=e.length>1?i.DEC_SEP+e[1]:"";if(W[W.length-1]==i.DEC_SEP&&R){S=i.DEC_SEP}var T=/(\d+)(\d{3})/;while(T.test(U)){U=U.replace(T,"$1"+i.THO_SEP+"$2")}return U+S},parseI:function(R){var e=H.parseF(R);if(new RegExp(E.data.thousandAbb+"$","i").test(R)){e=e*1000}else{if(new RegExp(E.data.millionAbb+"$","i").test(R)){e=e*1000000}}return Math.round(e)},parseF:function(e){return parseFloat(e.replaceAll(i.THO_SEP,"").replace(i.DEC_SEP,".").replace(/[^\d\.]/g,""))}};var j=function(){if(arguments.length<1){this.setLimits()}else{if(arguments.length<2){this.setLimits(arguments[0])}else{this.setLimits(arguments[0],arguments[1])}}};j.prototype={limits:[],isLegal:function(){var S;if(arguments.length==1){S=arguments[0]}else{S=[arguments[0],arguments[1],arguments[2]]}var R=S[0]/S[1],e=0;if(R<this.limits[e++]||R>this.limits[e++]){return false}R=S[0]/S[2];if(R<this.limits[e++]||R>this.limits[e++]){return false}R=S[1]/S[2];if(R<this.limits[e++]||R>this.limits[e++]){return false}return true},setLimits:function(T,S){if(arguments.length<2){var X,W,U,V=(arguments.length>0)?T.ratioList:E.data.ratioList;for(U in V){if(V[U].id=="MAX"){X=V[U].ratio}else{if(V[U].id=="MIN"){W=V[U].ratio}}}return this.setLimits(X,W)}this.limits=[];var R=T[0]/T[1],e=S[0]/S[1];this.limits.push(Math.min(R,e));this.limits.push(Math.max(R,e));R=T[0]/T[2];e=S[0]/S[2];this.limits.push(Math.min(R,e));this.limits.push(Math.max(R,e));R=T[1]/T[2];e=S[1]/S[2];this.limits.push(Math.min(R,e));this.limits.push(Math.max(R,e));return this}};var Q,a;var f=function(U,V,T,X,Y,W,R,S,e){return{met:Math.round(((U+(V/Y)*X+(T/W)*X)/100)*R),cry:Math.round((((U/X)*Y+V+(T/W)*Y)/100)*S),deu:Math.round((((U/X)*W+(V/Y)*W+T)/100)*e)}};var O={parseIf:function(W,X,e){var Y="{?"+X+"}",T="{/"+X+"}";if(e){return W.split(Y).join("").split(T).join("")}var V,U,R,S=W;while((V=S.indexOf(Y))>=0&&(U=S.indexOf(T))>=0&&V<U){S=S.split(Y);for(V=1;V<S.length;V++){R=S[V].split(T);if(R.length>1){R.shift();S[V]=T+R.shift()+R.join(T)}}S=S.join(Y).split(Y+T).join("")}return S},parseIfs:function(V,Z){var U=V+"",T=V+"",ab=/\{\?(\!?\w)+\}/,X,aa,Y,S,R;while(ab.test(U)){X=(ab.exec(U)+"").replace(/\}.*$/,"").replace(/^.*\{/,"");U=U.split("{"+X+"}").join("");try{X=X.replace(/[^\w\!]/g,"");if((R=X[Y=0])=="!"){aa=!Z[++Y]}else{aa=Z[R]}S=X.length-1;aa=Z[X[Y]];while(Y<S){if((R=X[++Y])=="!"){aa=(aa||!Z[++Y])}else{aa=(aa||Z[R])}}T=this.parseIf(T,X,aa)}catch(W){alert(W)}}return T},make:function(T,Y,e,S,R,X,V){var W,Z=/[1-9]/,U=this.parseIfs(E.data.messageTpl,{b:(T=="buy"),s:(T=="sell"),m:Z.test(Y.met),c:Z.test(Y.cry),d:Z.test(Y.deu),M:Z.test(e.met),C:Z.test(e.cry),D:Z.test(e.deu),w:V.use});U=U.replaceMap({"{m}":Y.met,"{c}":Y.cry,"{d}":Y.deu,"{M}":e.met,"{C}":e.cry,"{D}":e.deu,"{sr}":S.res,"{sl}":S.lc,"{ss}":S.sc,"{rr}":R.res,"{rl}":R.lc,"{rs}":R.sc,"{rm}":X.met,"{rc}":X.cry,"{rd}":X.deu,"{wg}":V.galaxy,"{ws}":V.system,"{wp}":V.planet,"{wt}":V.use?"{I18N."+(V.type+"").toUpperCase()+"}":0});for(W in i){U=U.replaceAll("{I18N."+W+"}",i[W])}for(W in F){U=U.replaceAll("{SCRIPT."+W+"}",F[W])}for(W in y){U=U.replaceAll("{COLOR."+W+"}",y[W])}return U}};var K=function(R,e){this.jqo=R;if(arguments.length>1){this.val(e)}};K.prototype={val:function(e){if(arguments.length<1){return this.jqo.val()}this.jqo.val(e);return this},disable:function(){this.jqo.attr("disabled","disabled").prop("disabled",true);return this},enable:function(){this.jqo.prop("disabled",false).removeAttr("disabled");return this},isDisabled:function(){return(this.jqo.attr("disabled")=="disabled")}};var v=function(R,e){this.jqo=R;if(arguments.length>1){this.val(e)}};v.prototype=w.extend({},K.prototype,{val:function(e){if(arguments.length<1){return this.isChecked()}if(e){this.check()}else{this.uncheck()}return this},check:function(){this.jqo.attr("checked","checked").prop("checked",true);return this},uncheck:function(){this.jqo.prop("checked",false).removeAttr("checked");return this},isChecked:function(){return(this.jqo.attr("checked")=="checked")}});var B=function(V,U,S,T){var W=this,e=(W.jqo=V),R;W.value=U;W.regExp=S;W.clearOnFocus=T;W.allowEmpty=true;W.onChange=t;if(arguments.length>4){if(arguments.length>5){W.allowEmpty=arguments[4];W.onChange=arguments[5]}else{if(typeof(arguments[4])=="function"){W.onChange=arguments[4]}else{W.allowEmpty=(arguments[4]&&true)}}}R=function(){var Z=e.val(),X=Z.length;J.console.log(W.regExp,'"'+Z+'"',W.regExp.test(Z));if(W.allowEmpty||X>0){if(W.regExp.test(Z)){W.value=Z.trim()}else{var aa=e.caret(),ab=X-aa.start,Y=X-aa.end;X=W.value.length;ab=Math.max(Math.min(X-ab,X),0);Y=Math.max(Math.min(X-Y,X),0);e.val(W.value);e.caret(ab,Y)}W.onChange()}};e.val(U).keyup(R).change(R).blur(function(){e.val(W.value)}).focus(function(){if(W.clearOnFocus){if(W.allowEmpty){W.val("")}else{e.val("")}}})};B.prototype=w.extend({},K.prototype,{val:function(e){if(arguments.length<1){return this.value}this.jqo.val(this.value=e);return this}});var l=function(W,V,U,T){var X=this,e=(this.jqo=W),S,R=U;this.allow0=true;this.focused=false;this.onChange=t;this.clearOnFocus=T;R=U.substring(0,1).toUpperCase();if(this.typePercent=(R=="P")){R="F"}this.formatFunc=H["format"+R];this.parseFunc=H["parse"+R];if(arguments.length>4){if(arguments.length>5){this.allow0=arguments[4];this.onChange=arguments[5]}else{if(typeof(arguments[4])=="function"){this.onChange=arguments[4]}else{this.allow0=(arguments[4]&&true)}}}this.set(V);S=function(){var ac=X.jqo,aa=ac.val(),ab=ac.caret(),Y=aa.length,ad=Y-ab.start,Z=Y-ab.end;aa=X.formatFunc(ac.val(),true);Y=aa.length;ad=Math.max(Math.min(Y-ad,Y),0);Z=Math.max(Math.min(Y-Z,Y),0);num=(aa=="")?0:X.parseFunc(aa);if(X.allow0||num>0){X.set(aa,true).onChange(X)}ac.caret(ad,Z)};e.keyup(function(Y){if(!(/^9|16$/.test(Y.which+""))){S()}}).change(S).blur(function(){X.set(X.num);X.focused=false}).focus(function(){X.focused=true;var aa=w(this);if(X.clearOnFocus||X.num==0){aa.val("")}else{var Z=aa.caret(),Y=aa.val().length;aa.val(X.formatFunc(X.num,true));if(Z.end==Y){if(Z.start==Y){Z.start=(--Z.end)}else{Z.end--}}Y=aa.val().length;aa.caret(Math.min(Math.max(0,Z.start),Y),Math.min(Math.max(0,Z.end),Y))}}).mouseenter(function(){if(E.data.overUnabb&&!(X.typePercent||X.focused||X.clearOnFocus)){var Y=X.jqo;Y.val(X.formatFunc(X.num,true));if(Y.val()==""){Y.val(0)}}}).mouseleave(function(){if(E.data.overUnabb&&!(X.typePercent||X.focused||X.clearOnFocus)){X.jqo.val(X.txt)}})};l.prototype=w.extend({},K.prototype,{set:function(T,S){var e,R=(arguments.length>1&&S);if(typeof(T)=="string"){e=(T+"").replace(/\%$/,"");this.num=(e=="")?0:this.parseFunc(e);this.txt=this.formatFunc(this.num)+(this.typePercent?"%":"")}else{this.num=T;this.txt=(e=this.formatFunc(T))+(this.typePercent?"%":"")}this.jqo.val(R?e:this.txt);return this}});var D=function(R,e){var S=this;S.jqo=R;S.val(e);S.jqo.mouseenter(function(){S._mouseenter()}).mouseleave(function(){S._mouseleave()})};D.prototype={val:function(e){if(arguments.length>0){this.jqo.text(H.formatI(e));this.num=e;return this}return this.jqo.text()},_mouseenter:function(){if(E.data.overUnabb&&this.num>0){this.jqo.text(H.formatI(this.num,true))}},_mouseleave:function(){if(E.data.overUnabb){this.jqo.text(H.formatI(this.num))}}};var I=function(U,S){var V=this,e=(this.jqo=U);this.onChange=S;e.change(function(){V.set().onChange()});w('<option value="">-</option>').appendTo(e);var T=w('meta[name="ogame-planet-coordinates"]').attr("content").replace(/[^0-9\:]/g,"");var R=w('meta[name="ogame-planet-type"]').attr("content").toLowerCase().trim();w.each(w("#planetList").children("div").get(),function(W,X){var Y=w(X),Z=Y.find(".planet-koords");if(Z.get().length==0){return}Z=Z.text().replace(/[^0-9\:]/g,"");option=w('<option value="planet:'+Z+'">['+Z+"] "+Y.find(".planet-name").text().trim()+"</option>").appendTo(e);if(Z==T&&R=="planet"){V._setCurrent(option)}if(Y.find(".moonlink").get().length>0){option=w('<option value="moon:'+Z+'">['+Z+"] ("+i.MOON+")</option>").appendTo(e).addClass(p+"moon");if(Z==T&&R=="moon"){V._setCurrent(option)}}})};I.prototype={use:false,type:0,galaxy:0,system:0,planet:0,set:function(e){var R=((arguments.length>0)?e:this.jqo.val()).split(":");if(R.length<4){this.use=false}else{this.use=true;this.type=R.shift();this.galaxy=R.shift();this.system=R.shift();this.planet=R.shift()}return this},_setCurrent:function(e){e.addClass(p+"highlight").html(e.html()+" &laquo; "+i.CUR_PLA);if(E.data.selCurPla){e.attr("selected","selected")}this.current=e;this.set()},clickCurrent:function(){this.jqo.val(this.current.val()).change()}};var G=function(T,W,U){var R,e,V=this,S;if(arguments.length<4){this.isNew=false;this.name=("name" in U)?U.name:(U.id=="MAX")?i.MAX:(U.id=="MIN")?i.MIN:i.REG;this.id=U.id;S=U.ratio}else{this.isNew=true;this.name="*"+i.NEW;S=E.getRatioById(U.defRatio,U).ratio}this.list=T;if(this.isLimit=/^MIN|MAX$/.test(this.id)){this.jqo=w(k.RATIO_LIST_LIMIT).appendTo(T.jqo);this.jqo.find("."+p+"name_noedit").text(this.name)}else{this.jqo=w(this.isNew?k.RATIO_LIST_NEW:k.RATIO_LIST_ITEM).appendTo(T.jqo);this.nameInput=this.jqo.find("."+p+"edit_ratio_name");this.nameInput.change(function(){V.name=V.nameInput.val().trim()}).keyup(function(){V.nameInput.change()}).val(this.name)}this.posLabel=this.jqo.find("."+p+"pos");this.setPos(W);e=["met","cry","deu"];for(R in e){this[e[R]+"Input"]=new l(this.jqo.find("."+p+"edit_ratio_"+e[R]),S[R],"f",true,false,function(){V.list.onChange()})}this.addButton=this.jqo.find("."+p+"icon_add").click(function(){var Y=V.list,X=new G(Y,V.pos,V.getInfo());X.disableDown().jqo.after(V.jqo);Y.list[V.pos]=X;Y.list[V.pos-1].enableDown();V.nameInput.val(V.name="*"+i.NEW);V.setPos(++V.pos)});this.upButton=this.jqo.find("."+p+"icon_up").click(function(){V.move(true)});this.upDisabled=false;this.downButton=this.jqo.find("."+p+"icon_down").click(function(){V.move(false)});this.downDisabled=false;this.trashButton=this.jqo.find("."+p+"icon_trash");if(this.isLimit){this.trashButton.addClass("disabled")}else{this.trashButton.click(function(){V.remove()})}this.radio=this.jqo.find('input[name="'+p+'def_ratio"]').click(function(){V.list.defRatio=V.id});if(T.defRatio==this.id){this.radio.click()}this.legal=this.jqo.find("."+p+"legal")};G.prototype={getInfo:function(){var R=this,e={id:R.isNew?L():R.id,ratio:[R.metInput.num,R.cryInput.num,R.deuInput.num]};if((!R.isLimit)&&(R.isNew||R.id!="REG"||R.name!=i.REG)){e.name=R.name}return e},move:function(R){var S,e;if(R){if(this.upDisabled){return this}S=this.list.list[this.pos-1];this.jqo.after(S.jqo)}else{if(this.downDisabled){return this}S=this.list.list[this.pos+1];S.jqo.after(this.jqo)}e=this.pos;this.setPos(S.pos);S.setPos(e);e=S.upDisabled;if(this.upDisabled){S.disableUp()}else{S.enableUp()}if(e){this.disableUp()}else{this.enableUp()}e=S.downDisabled;if(this.downDisabled){S.disableDown()}else{S.enableDown()}if(e){this.disableDown()}else{this.enableDown()}this.list.sortList()},remove:function(){var S,e=[],T=this.list.list,R=this.list.newItem;this.jqo.remove();T.splice(this.pos,1);for(S=0;S<T.length;S++){e[S]=(T[S].setPos(S))}this.list.list=e;if(this.list.defRatio==this.id){e[0].radio.click()}if(this.downDisabled){e[e.length-1].disableDown()}if(this.upDisabled){e[0].disableUp()}R.setPos(R.pos-1)},enableUp:function(){this.upDisabled=false;this.upButton.removeClass("disabled");return this},enableDown:function(){this.downDisabled=false;this.downButton.removeClass("disabled");return this},disableUp:function(){this.upDisabled=true;this.upButton.addClass("disabled");return this},disableDown:function(){this.downDisabled=true;this.downButton.addClass("disabled");return this},setLegal:function(e){if(e){this.legal.text(i.YES).addClass("undermark").removeClass("overmark")}else{this.legal.text(i.NO).addClass("overmark").removeClass("undermark")}return this},setPos:function(e){if(e%2==0){this.jqo.addClass("alt")}else{this.jqo.removeClass("alt")}this.pos=e;this.posLabel.html(this.isNew?"+":e+1);return this}};var r={list:[],limits:[],clear:function(){for(var R in this.list){this.list[R].jqo.remove()}this.list=(this.limits=[]);try{this.newItem.jqo.remove()}catch(S){}},sortList:function(){this.list.sort(function(R,e){return R.pos-e.pos})},build:function(R){var T,U,S=(arguments.length>0)?R:E.data;this.clear();this.defRatio=S.defRatio;for(T=0;T<S.ratioList.length;T++){U=new G(this,T,S.ratioList[T]);this.list[T]=U;if(U.isLimit){this.limits[this.limits.length]=U}}var e=this.list.length;this.newItem=new G(this,e,S,true);this.list[0].disableUp();this.list[e-1].disableDown();this.onChange()},updateData:function(e){var S=(arguments.length>0)?e:E.data;S.ratioList=[];for(var R in this.list){S.ratioList[R]=this.list[R].getInfo()}S.defRatio=this.defRatio},onChangeItem:function(e){if(!e.isLimit){e.setLegal(a.isLegal(e.getInfo().ratio))}},onChange:function(){a.setLimits(this.limits[0].getInfo().ratio,this.limits[1].getInfo().ratio);for(var e=0;e<this.list.length;e++){this.onChangeItem(this.list[e])}this.onChangeItem(this.newItem)},init:function(e){this.jqo=e}};var u=function(R,V,S,e,U){var T=this;this.list=R;this.iface=U;this.pos=V;this.title=S.click(function(){T._click()});this.box=e;if(e.hasClass(p+"hidden")){this.setOpen(false)}else{this.setOpen(true)}};u.prototype={updateOpenCss:function(){this.openCss={height:this.box.height()+"px","padding-top":this.box.css("padding-top"),"padding-bottom":this.box.css("padding-bottom"),"margin-top":this.box.css("margin-top"),"margin-bottom":this.box.css("margin-bottom")};return this},closeCss:{height:0,"padding-top":0,"padding-bottom":0,"margin-top":0,"margin-bottom":0},afterOpenCss:{height:"auto"},duration:250,setOpen:function(e){if(this.isOpen=e){this.list.itemOpen=this}return this},open:function(){this.updateOpenCss().box.removeClass(p+"hidden");return this.setOpen(true)},close:function(){this.updateOpenCss().box.addClass(p+"hidden");return this.setOpen(false)},animateOpen:function(){var e=this.afterOpenCss;this.updateOpenCss().box.css(this.closeCss).removeClass(p+"hidden").animate(this.openCss,this.duration,function(){w(this).css(e)});return this.setOpen(true)},animateClose:function(){var e=this;this.updateOpenCss().box.css(this.openCss).animate(this.closeCss,this.duration,function(){w(this).addClass(p+"hidden").css(e.openCss).css(e.afterOpenCss)});return this.setOpen(false)},_click:function(){if(!this.isOpen){this.iface.clearExport();this.list.itemOpen.animateClose();this.animateOpen()}}};var x={init:function(S,T){this.jqo=S;var R,e=[];S.find("."+p+"config_title").each(function(U,V){e[U]={title:w(V)}});S.find("."+p+"config_box").each(function(U,V){e[U].box=w(V)});this.list=[];for(R=0;R<e.length;R++){this.list[R]=new u(this,R,e[R].title,e[R].box,T)}}};var q=({addCss:function(S){var R=h.createElement("style");R.setAttribute("type","text/css");if(R.styleSheet){R.styleSheet.cssText=S}else{R.appendChild(h.createTextNode(S))}var e=h.getElementsByTagName("head")[0];e.appendChild(R);return this},findIDP:function(e){return this.window.find("#"+p+e)},menuButton:null,menuButtonAction:function(){this.menuButtonAction=function(){};this.makeWindow()},makeMenuButton:function(){var e=this;this.menuButton=w(k.MENUBUTTON).appendTo(w("#menuTableTools")).find("#"+p+"menubutton").click(function(){e.menuButtonAction()});return e},window:null,ogameHide:null,isHidden:true,show:function(){this.isHidden=false;this.ogameHide.hide();this.window.show();return this},hide:function(){this.isHidden=true;this.window.hide();this.ogameHide.show();return this},toggle:function(){if(this.isHidden){return this.show()}return this.hide()},makePlanetSelect:function(){var e=this;e.planet=new I(e.findIDP("planet"),function(){e.onChange()});return e},makeActionSelect:function(){var e=this;e.actionJqo=e.findIDP("action").change(function(){e.action=w(this).val();e.onChange()}).val(e.action=E.data.defAction);return e},makeResourceInput:function(e,R){var S=this;S["input"+e.capitalize()]=new l(S.findIDP("input_"+e),R,"i",false,true,function(){S.checkOutputSelect().onChange()});return S},makeRatioSelect:function(){var e=this;this.ratioSelectJqo=e.findIDP("ratio").change(function(){var R=w(this).val().split(":");if(R.length>3){w(this).val("");e.ratioMet.set(parseFloat(R[1]));e.ratioCry.set(parseFloat(R[2]));e.ratioDeu.set(parseFloat(R[3]));e.checkRatio().onChange()}});return e.updateRatioSelect()},updateRatioSelect:function(){var R,e=this.ratioSelectJqo.html("").append(w('<option value="">-</option>'));for(R in E.data.ratioList){ratio=E.getRatio(R);e.append(w('<option value="'+ratio.val+'">'+H.formatF(ratio.met)+":"+H.formatF(ratio.cry)+":"+H.formatF(ratio.deu)+" ("+ratio.name+")</option>"))}return this},makeRatioInput:function(e,R){var S=this;S["ratio"+e.capitalize()]=new l(S.findIDP("ratio_"+e),R,"f",true,false,function(){S.checkRatio().onChange()});return S},checkRatio:function(){var e=this;if(Q.isLegal(e.ratioMet.num,e.ratioCry.num,e.ratioDeu.num)){e.ratioIllegal.hide()}else{e.ratioIllegal.show()}return e},makePercentInput:function(e){var S=this,R="percent"+e.capitalize();S[R]=new l(S.findIDP("percent_"+e),0,"p",false,true,function(V){if(V.num>100){V.set(100,true)}var T="percentMet",U;if(/Met|Cry/.test(R)&&(!S.percentDeu.isDisabled())){T="percentDeu"}else{if(/Met|Deu/.test(R)&&(!S.percentCry.isDisabled())){T="percentCry"}}U=parseFloat((100-V.num).toFixed((V.num+"").split(".").pop().length));S[T].set(U);S.onChange()});return S},checkOutputSelect:function(){var V=this,Y=V.outputJqo,T=Y.val(),X=(V.inputMet.num>0),U=(V.inputCry.num>0),S=(V.inputDeu.num>0),W=/m/.test(T),R=/c/.test(T),e=/d/.test(T);if(!X&&!U&&S&&!W&&!R&&e){Y.val("mc").change()}else{if(!X&&U&&!S&&!W&&R&&!e){Y.val("md").change()}else{if(X&&!U&&!S&&W&&!R&&!e){Y.val("cd").change()}else{if((!X&&U&&S)||W&&((U&&R)||(S&&e))){Y.val("m").change()}else{if((X&&!U&&S)||R&&((X&&W)||(S&&e))){Y.val("c").change()}else{if((X&&U&&!S)||e&&((X&&W)||(U&&R))){Y.val("d").change()}}}}}}return V},changeOutputSelect:function(e){this.outputJqo.val(e);m=this.percentMet.disable().set(0),c=this.percentCry.disable().set(0),d=this.percentDeu.disable().set(0);if(e=="m"){m.set(100)}else{if(e=="c"){c.set(100)}else{if(e=="d"){d.set(100)}else{if(e=="mc"){m.enable().set(50);c.enable().set(50)}else{if(e=="md"){m.enable().set(50);d.enable().set(50)}else{c.enable().set(50);d.enable().set(50)}}}}}return this},makeOutputSelect:function(){var e=this;this.outputJqo=e.findIDP("output").change(function(){e.changeOutputSelect(w(this).val());e.onChange()});return e},toggleConfigCalc:function(){this.window.toggleClass("config").toggleClass("calc");return this},updateConfigData:function(e){var S=this,R=(arguments.length>0)?e:E.data;r.updateData(R);R.defAction=S.defAction.val();R.defOutput=S.defOutput.val();R.selCurPla=S.selCurPla.val();R.abb=S.abb.val();R.overUnabb=S.overUnabb.val();R.millionAbb=S.millionAbb.val();R.millionKey=S.millionKey.val();R.thousandAbb=S.thousandAbb.val();R.thousandKey=S.thousandKey.val();R.messageTpl=S.messageTpl.val();return S},updateConfigIface:function(e){var S=this,R=(arguments.length>0)?e:E.data;a.setLimits(R);r.build(R);S.defAction.val(R.defAction);S.defOutput.val(R.defOutput);S.selCurPla.val(R.selCurPla);S.abb.val(R.abb);S.overUnabb.val(R.overUnabb);S.millionAbb.val(R.millionAbb);S.millionKey.val(R.millionKey);S.thousandAbb.val(R.thousandAbb);S.thousandKey.val(R.thousandKey);S.messageTpl.val(R.messageTpl);S.ieInput.val("");return S},updateCalcIface:function(){Q.setLimits();this.inputMet.set(this.inputMet.num);this.inputCry.set(this.inputCry.num);this.inputDeu.set(this.inputDeu.num);this.updateRatioSelect().checkRatio().onChange();return this},makeConfigButtons:function(){var e=this;e.findIDP("config_but").click(function(){e.toggleConfigCalc()});e.findIDP("config_accept").click(function(){e.updateConfigData();E.save();e.updateCalcIface();e.toggleConfigCalc()});e.findIDP("config_cancel").click(function(){e.updateConfigIface();e.toggleConfigCalc()});e.findIDP("config_default").click(function(){E.remove();e.updateCalcIface();e.updateConfigIface();e.toggleConfigCalc()});return e},makeImportExport:function(){var e=this;e.ieInput=e.findIDP("ie_conf").focus(function(){w(this).select()});e.findIDP("ie_import").click(function(){try{var R=E.parseData(e.ieInput.val());e.updateConfigIface(R)}catch(S){alert(S)}});e.findIDP("ie_export").click(function(){var R=w.extend({},E.data);e.updateConfigData(R);e.ieInput.val("").val(JSON.stringify(R)).select()});return e},makeAbbKey:function(){var e=this;e.abb=new v(e.findIDP("abb"));e.overUnabb=new v(e.findIDP("overUnabb"));e.millionAbb=new B(e.findIDP("millionAbb"),E.data.millionAbb,E.abbRE,true,false);e.thousandAbb=new B(e.findIDP("thousandAbb"),E.data.thousandAbb,E.abbRE,true,false);e.millionKey=new B(e.findIDP("millionKey"),E.data.millionKey,E.keyRE,true,false);e.thousandKey=new B(e.findIDP("thousandKey"),E.data.thousandKey,E.keyRE,true,false);return e},makeMessageTpl:function(){var e=this;e.messageTpl=e.findIDP("messageTpl");e.findIDP("messageTpl_restore").click(function(){e.messageTpl.val(E.getDefaultData().messageTpl)});return e},clearExport:function(){this.ieInput.val("");return this},needUpdate:false,showUpdate:function(){this.needUpdate=true;this.menuButton.addClass("middlemark");try{this.findIDP("main").before(w(k.UPDATE))}catch(R){}},ogameDropDown:function(X){var V,U,S=w(".dropdown.dropdownList").get(),T,W,e,R,Y;X.ogameDropDown();Y={select:X};R=function(){var aa,Z;aa=Y.select.val();Z=Y.select.find('[value="'+aa+'"]').text();Y.dropdown.attr("data-value",aa).text(Z)};T=w(".dropdown.dropdownList").get();for(V=0;V<S.length;V++){S[V]=w(S[V])}for(V=0;V<T.length;V++){T[V]=w(T[V]);e=T[V].attr("id");W=true;for(U=0;U<S.length;U++){if(S[U].attr("id")==e){W=false;break}}if(W){Y.dropdown=w('.dropdown [rel="'+e+'"]');Y.dropdownList=T[V];R();X.change(R);break}}},ogameDropDowns:function(){var R,e=this.window.find("select").get();for(R=0;R<e.length;R++){this.ogameDropDown(w(e[R]))}},makeWindow:function(){k.init();E.load();Q=new j();a=new j();var R=this,e=E.getRatioById(E.data.defRatio);R.ogameHide=w("#inhalt").after(this.window=w(k.WINDOW).hide());if(R.needUpdate){R.showUpdate()}R.addCss(k.CSS).show();R.ratioIllegal=R.findIDP("ratio_illegal").hide();R.outputMessage=R.findIDP("message").click(function(){w(this).select()});R.outputMet=new D(R.findIDP("output_met"),0);R.outputCry=new D(R.findIDP("output_cry"),0);R.outputDeu=new D(R.findIDP("output_deu"),0);R.sendRes=new D(R.findIDP("sendRes"),0);R.sendLC=new D(R.findIDP("sendLC"),0);R.sendSC=new D(R.findIDP("sendSC"),0);R.receiveRes=new D(R.findIDP("receiveRes"),0);R.receiveLC=new D(R.findIDP("receiveLC"),0);R.receiveSC=new D(R.findIDP("receiveSC"),0);R.findIDP("close").click(function(){R.hide()});R.makeActionSelect().makeResourceInput("met",0).makeResourceInput("cry",0).makeResourceInput("deu",0).makeRatioSelect().makeRatioInput("met",e.met).makeRatioInput("cry",e.cry).makeRatioInput("deu",e.deu).makeOutputSelect().makePercentInput("met").makePercentInput("cry").makePercentInput("deu").changeOutputSelect(E.data.defOutput).makePlanetSelect().checkRatio();R.findIDP("selCurPla_button").click(function(){R.planet.clickCurrent()});R.menuButtonAction=function(){R.toggle()};R.makeImportExport();x.init(R.findIDP("config"),R);r.init(R.findIDP("ratioList"),this);R.defAction=R.findIDP("defAction");R.defOutput=R.findIDP("defOutput");R.selCurPla=new v(R.findIDP("selCurPla"));R.makeAbbKey().makeMessageTpl().makeConfigButtons().updateConfigIface();R.ogameDropDowns();return R},onChange:function(){var R=this,e=f(R.inputMet.num,R.inputCry.num,R.inputDeu.num,R.ratioMet.num,R.ratioCry.num,R.ratioDeu.num,R.percentMet.num,R.percentCry.num,R.percentDeu.num);R.outputMet.val(e.met);R.outputCry.val(e.cry);R.outputDeu.val(e.deu);if(R.action=="buy"){R.sendRes.val(e.met+e.cry+e.deu);R.receiveRes.val(R.inputMet.num+R.inputCry.num+R.inputDeu.num)}else{R.receiveRes.val(e.met+e.cry+e.deu);R.sendRes.val(R.inputMet.num+R.inputCry.num+R.inputDeu.num)}R.sendLC.val(Math.ceil(R.sendRes.num/25000));R.sendSC.val(Math.ceil(R.sendRes.num/5000));R.receiveLC.val(Math.ceil(R.receiveRes.num/25000));R.receiveSC.val(Math.ceil(R.receiveRes.num/5000));R.outputMessage.text(O.make(R.action,{met:R.inputMet.txt,cry:R.inputCry.txt,deu:R.inputDeu.txt,},{met:R.outputMet.val(),cry:R.outputCry.val(),deu:R.outputDeu.val(),},{res:R.sendRes.val(),lc:R.sendLC.val(),sc:R.sendSC.val(),},{res:R.receiveRes.val(),lc:R.receiveLC.val(),sc:R.receiveSC.val(),},{met:R.ratioMet.txt,cry:R.ratioCry.txt,deu:R.ratioDeu.txt,},R.planet));return R},init:function(){return this.makeMenuButton()}}).init();var n=(typeof(GM_xmlhttpRequest)=="undefined")?function(){w("body").append(w('<script src="'+F.UPDATE_JSONP+'" type="text/javascript" />'))}:function(){GM_xmlhttpRequest({method:"GET",url:F.UPDATE_URL,onload:function(R){var e=R.responseText.split("\n"),S,T=/^\s*\/\/\s*\@version\s+(\d+(?:\.\d+)*)\s*$/;for(S in e){if(T.test(e[S])){return J[p+"onVersionFound"](e[S].replace(T,"$1"))}}}})};var s=Math.floor(L()/1000);var o={defaultData:function(){return{interval:7,noCheck:false,version:F.VERSION,timestamp:0,versionOG:g.VERSION}},load:function(){this.data=C.get("cfu");this.data=w.extend(this.defaultData(),(this.data==null)?{}:this.data)},update:function(e){w.extend(this.data,{timestamp:s,versionOG:g.VERSION,version:(arguments.length>0)?e:this.data.version});C.set("cfu",this.data)},save:function(e){this.data=w.extend(this.defaultData(),this.data,(arguments.length>0)?e:{});C.set("cfu",this.data)}};var N=function(R){var e=R;o.load();if(o.data.noCheck){return o.update(F.VERSION)}if(z(F.VERSION,o.data.version)){o.update();return e()}if((z(o.data.versionOG,g.VERSION))||(s>o.data.timestamp+86400*o.data.interval)){J[p+"onVersionFound"]=function(S){o.update(b(S));if(z(F.VERSION,o.data.version)){e()}};n()}};setTimeout(function(){N(function(){q.showUpdate()})},1)})();